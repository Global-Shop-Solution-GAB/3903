Program.Sub.ScreenSU.Start
gui.F_Main..create
gui.F_Main..caption("F_Main Form")
gui.F_Main..size(17295,9510)
gui.F_Main..minx(0)
gui.F_Main..miny(0)
gui.F_Main..position(0,0)
gui.F_Main..event(resize,E_F_Main_Resize)
gui.F_Main..event(unload,subExit)
gui.F_Main..alwaysontop(False)
gui.F_Main..fontname("Arial")
gui.F_Main..fontsize(8)
gui.F_Main..forecolor(0)
gui.F_Main..fontstyle(,,,,)
gui.F_Main..BackColor(-2147483633)
gui.F_Main..controlbox(True)
gui.F_Main..maxbutton(True)
gui.F_Main..minbutton(True)
gui.F_Main..mousepointer(0)
gui.F_Main..moveable(True)
gui.F_Main..sizeable(True)
gui.F_Main..ShowInTaskBar(True)
gui.F_Main..titlebar(True)
gui.F_Main.frmLowerHalf.create(frame)
gui.F_Main.frmLowerHalf.caption("")
gui.F_Main.frmLowerHalf.size(9090,1875)
gui.F_Main.frmLowerHalf.position(75,6885)
gui.F_Main.frmLowerHalf.visible(True)
gui.F_Main.frmLowerHalf.borderstyle(0)
gui.F_Main.frmLowerHalf.fontname("Arial")
gui.F_Main.frmLowerHalf.fontsize(8)
gui.F_Main.frmFilter.create(frame)
gui.F_Main.frmFilter.caption("Filters")
gui.F_Main.frmFilter.parent("frmlowerhalf")
gui.F_Main.frmFilter.size(6720,975)
gui.F_Main.frmFilter.position(1325,200)
gui.F_Main.frmFilter.visible(True)
gui.F_Main.frmFilter.fontname("Arial")
gui.F_Main.frmFilter.fontsize(8)
gui.F_Main.frmWOopt.create(frame)
gui.F_Main.frmWOopt.caption("WO Opt")
gui.F_Main.frmWOopt.parent("frmlowerhalf")
gui.F_Main.frmWOopt.size(930,960)
gui.F_Main.frmWOopt.position(200,200)
gui.F_Main.frmWOopt.visible(True)
gui.F_Main.frmWOopt.fontname("Arial")
gui.F_Main.frmWOopt.fontsize(8)
gui.F_Main.fgOpenJobs.create(gsflexgrid)
gui.F_Main.fgOpenJobs.FixedRows(0)
gui.F_Main.fgOpenJobs.FixedCols(0)
gui.F_Main.fgOpenJobs.visible(True)
gui.F_Main.fgOpenJobs.size(16740,6885)
gui.F_Main.fgOpenJobs.zorder(0)
gui.F_Main.fgOpenJobs.position(100,105)
gui.F_Main.fgOpenJobs.enabled(True)
gui.F_Main.fgOpenJobs.event(mouseup,E_fgOpenJobs_MouseUp)
gui.F_Main.fgOpenJobs.event(posttextmatrix,fgopenjobs_posttextmatrix)
gui.F_Main.fgOpenJobs.event(cellenter,E_fgOpenJobs_CellEnter)
gui.F_Main.fgOpenJobs.event(checkclick,fgopenjobs_checkclick)
gui.F_Main.cmdExportExcel.create(button)
gui.F_Main.cmdExportExcel.caption("Export to Microsoft Excel")
gui.F_Main.cmdExportExcel.visible(True)
gui.F_Main.cmdExportExcel.size(2385,375)
gui.F_Main.cmdExportExcel.zorder(0)
gui.F_Main.cmdExportExcel.position(210,1320)
gui.F_Main.cmdExportExcel.enabled(True)
gui.F_Main.cmdExportExcel.parent("frmlowerhalf")
gui.F_Main.cmdExportExcel.fontname("Arial")
gui.F_Main.cmdExportExcel.fontsize(8)
gui.F_Main.cmdExportExcel.event(click,E_cmdExportExcel_Click)
gui.F_Main.cmdExportExcel.defaultvalue("")
gui.F_Main.cmdExportExcel.controlgroup(0)
gui.F_Main.cmdExportCalc.create(button)
gui.F_Main.cmdExportCalc.caption("Export to Open Office Calc")
gui.F_Main.cmdExportCalc.visible(True)
gui.F_Main.cmdExportCalc.size(2385,375)
gui.F_Main.cmdExportCalc.zorder(0)
gui.F_Main.cmdExportCalc.position(2685,1325)
gui.F_Main.cmdExportCalc.enabled(True)
gui.F_Main.cmdExportCalc.parent("frmlowerhalf")
gui.F_Main.cmdExportCalc.fontname("Arial")
gui.F_Main.cmdExportCalc.fontsize(8)
gui.F_Main.cmdExportCalc.event(click,E_cmdExportOO_Click)
gui.F_Main.cmdExportCalc.defaultvalue("")
gui.F_Main.cmdExportCalc.controlgroup(0)
gui.F_Main.cmdRefresh.create(button)
gui.F_Main.cmdRefresh.caption("REFRESH")
gui.F_Main.cmdRefresh.visible(True)
gui.F_Main.cmdRefresh.size(2040,540)
gui.F_Main.cmdRefresh.zorder(0)
gui.F_Main.cmdRefresh.position(5995,1230)
gui.F_Main.cmdRefresh.enabled(True)
gui.F_Main.cmdRefresh.parent("frmlowerhalf")
gui.F_Main.cmdRefresh.fontname("Arial Black")
gui.F_Main.cmdRefresh.fontsize(8)
gui.F_Main.cmdRefresh.event(click,E_cmdRefresh_Click)
gui.F_Main.cmdRefresh.defaultvalue("")
gui.F_Main.cmdRefresh.controlgroup(0)
gui.F_Main.prgLoad.create(progressbar)
gui.F_Main.prgLoad.visible(True)
gui.F_Main.prgLoad.size(14055,600)
gui.F_Main.prgLoad.zorder(0)
gui.F_Main.prgLoad.position(300,3000)
gui.F_Main.prgLoad.enabled(True)
gui.F_Main.lblLoadMsg.create(label,"Label",True,9660,2550,1,2900,2045,True,0,Arial,8,-2147483633,0)
gui.F_Main.lblLoadMsg.defaultvalue("")
gui.F_Main.lblLoadMsg.controlgroup(0)
gui.F_Main.cboPrtRel.create(combobox)
gui.F_Main.cboPrtRel.text("")
gui.F_Main.cboPrtRel.visible(True)
gui.F_Main.cboPrtRel.size(1485,330)
gui.F_Main.cboPrtRel.zorder(0)
gui.F_Main.cboPrtRel.position(90,545)
gui.F_Main.cboPrtRel.enabled(True)
gui.F_Main.cboPrtRel.parent("frmfilter")
gui.F_Main.cboPrtRel.fontname("Arial")
gui.F_Main.cboPrtRel.fontsize(8)
gui.F_Main.cboPrtRel.defaultvalue("")
gui.F_Main.cboPrtRel.controlgroup(0)
gui.F_Main.chkPrtRel.create(checkbox)
gui.F_Main.chkPrtRel.caption("Printed/Released")
gui.F_Main.chkPrtRel.visible(True)
gui.F_Main.chkPrtRel.size(1560,225)
gui.F_Main.chkPrtRel.zorder(0)
gui.F_Main.chkPrtRel.position(100,300)
gui.F_Main.chkPrtRel.enabled(True)
gui.F_Main.chkPrtRel.alignment(0)
gui.F_Main.chkPrtRel.parent("frmfilter")
gui.F_Main.chkPrtRel.fontname("Arial")
gui.F_Main.chkPrtRel.fontsize(8)
gui.F_Main.chkPrtRel.defaultvalue("")
gui.F_Main.chkPrtRel.controlgroup(0)
gui.F_Main.chkLoc.create(checkbox)
gui.F_Main.chkLoc.caption("Location:")
gui.F_Main.chkLoc.visible(True)
gui.F_Main.chkLoc.size(1275,255)
gui.F_Main.chkLoc.zorder(0)
gui.F_Main.chkLoc.position(1820,285)
gui.F_Main.chkLoc.enabled(True)
gui.F_Main.chkLoc.alignment(0)
gui.F_Main.chkLoc.parent("frmfilter")
gui.F_Main.chkLoc.fontname("Arial")
gui.F_Main.chkLoc.fontsize(8)
gui.F_Main.chkLoc.defaultvalue("")
gui.F_Main.chkLoc.controlgroup(0)
gui.F_Main.txtLoc.create(textbox,"",True,600,300,0,1795,540,True,0,Arial,8,-2147483643,1)
gui.F_Main.txtLoc.parent("frmfilter")
gui.F_Main.txtLoc.defaultvalue("")
gui.F_Main.txtLoc.controlgroup(0)
gui.F_Main.cmdLoc.create(button)
gui.F_Main.cmdLoc.caption("^")
gui.F_Main.cmdLoc.visible(True)
gui.F_Main.cmdLoc.size(315,285)
gui.F_Main.cmdLoc.zorder(0)
gui.F_Main.cmdLoc.position(2380,555)
gui.F_Main.cmdLoc.enabled(True)
gui.F_Main.cmdLoc.parent("frmfilter")
gui.F_Main.cmdLoc.fontname("Arial")
gui.F_Main.cmdLoc.fontsize(8)
gui.F_Main.cmdLoc.event(click,cmdloc_click)
gui.F_Main.cmdLoc.defaultvalue("")
gui.F_Main.cmdLoc.controlgroup(0)
gui.F_Main.chkPL.create(checkbox)
gui.F_Main.chkPL.caption("PL:")
gui.F_Main.chkPL.visible(False)
gui.F_Main.chkPL.size(780,255)
gui.F_Main.chkPL.zorder(0)
gui.F_Main.chkPL.position(2880,290)
gui.F_Main.chkPL.enabled(True)
gui.F_Main.chkPL.alignment(0)
gui.F_Main.chkPL.parent("frmfilter")
gui.F_Main.chkPL.fontname("Arial")
gui.F_Main.chkPL.fontsize(8)
gui.F_Main.chkPL.defaultvalue("")
gui.F_Main.chkPL.controlgroup(0)
gui.F_Main.txtPL.create(textbox,"",False,495,300,0,2865,535,True,0,Arial,8,-2147483643,1)
gui.F_Main.txtPL.parent("frmfilter")
gui.F_Main.txtPL.defaultvalue("")
gui.F_Main.txtPL.controlgroup(0)
gui.F_Main.cmdPL.create(button)
gui.F_Main.cmdPL.caption("^")
gui.F_Main.cmdPL.visible(False)
gui.F_Main.cmdPL.size(315,285)
gui.F_Main.cmdPL.zorder(0)
gui.F_Main.cmdPL.position(3345,535)
gui.F_Main.cmdPL.enabled(True)
gui.F_Main.cmdPL.parent("frmfilter")
gui.F_Main.cmdPL.fontname("Arial")
gui.F_Main.cmdPL.fontsize(8)
gui.F_Main.cmdPL.event(click,cmdpl_click)
gui.F_Main.cmdPL.defaultvalue("")
gui.F_Main.cmdPL.controlgroup(0)
gui.F_Main.cmdFilter.create(button)
gui.F_Main.cmdFilter.caption("FILTER")
gui.F_Main.cmdFilter.visible(True)
gui.F_Main.cmdFilter.size(1050,525)
gui.F_Main.cmdFilter.zorder(0)
gui.F_Main.cmdFilter.position(5430,300)
gui.F_Main.cmdFilter.enabled(True)
gui.F_Main.cmdFilter.parent("frmfilter")
gui.F_Main.cmdFilter.fontname("Arial Black")
gui.F_Main.cmdFilter.fontsize(8)
gui.F_Main.cmdFilter.event(click,cmdfilter_click)
gui.F_Main.cmdFilter.defaultvalue("")
gui.F_Main.cmdFilter.controlgroup(0)
gui.F_Main.optView.create(option)
gui.F_Main.optView.caption("View")
gui.F_Main.optView.visible(True)
gui.F_Main.optView.size(795,255)
gui.F_Main.optView.zorder(0)
gui.F_Main.optView.position(80,245)
gui.F_Main.optView.enabled(True)
gui.F_Main.optView.alignment(0)
gui.F_Main.optView.parent("frmwoopt")
gui.F_Main.optView.fontname("Arial")
gui.F_Main.optView.fontsize(8)
gui.F_Main.optView.event(click,subChangeGridStyle)
gui.F_Main.optView.defaultvalue("")
gui.F_Main.optView.controlgroup(0)
gui.F_Main.optEdit.create(option)
gui.F_Main.optEdit.caption("Edit")
gui.F_Main.optEdit.visible(True)
gui.F_Main.optEdit.size(795,255)
gui.F_Main.optEdit.zorder(0)
gui.F_Main.optEdit.position(70,545)
gui.F_Main.optEdit.enabled(True)
gui.F_Main.optEdit.alignment(0)
gui.F_Main.optEdit.parent("frmwoopt")
gui.F_Main.optEdit.fontname("Arial")
gui.F_Main.optEdit.fontsize(8)
gui.F_Main.optEdit.event(click,subChangeGridStyle)
gui.F_Main.optEdit.defaultvalue("")
gui.F_Main.optEdit.controlgroup(0)
gui.F_Main.dtpDueDate.create(datepicker)
gui.F_Main.dtpDueDate.visible(True)
gui.F_Main.dtpDueDate.size(1470,300)
gui.F_Main.dtpDueDate.zorder(0)
gui.F_Main.dtpDueDate.position(3715,545)
gui.F_Main.dtpDueDate.enabled(True)
gui.F_Main.dtpDueDate.parent("frmfilter")
gui.F_Main.dtpDueDate.checkbox(False)
gui.F_Main.dtpDueDate.defaultvalue("")
gui.F_Main.dtpDueDate.controlgroup(0)
gui.F_Main.chkWODue.create(checkbox)
gui.F_Main.chkWODue.caption("Cut off - Due Dt:")
gui.F_Main.chkWODue.visible(True)
gui.F_Main.chkWODue.size(1500,225)
gui.F_Main.chkWODue.zorder(0)
gui.F_Main.chkWODue.position(3730,315)
gui.F_Main.chkWODue.enabled(True)
gui.F_Main.chkWODue.alignment(0)
gui.F_Main.chkWODue.parent("frmfilter")
gui.F_Main.chkWODue.fontname("Arial")
gui.F_Main.chkWODue.fontsize(8)
gui.F_Main.chkWODue.defaultvalue("")
gui.F_Main.chkWODue.controlgroup(0)
gui.F_Main.cmdNext.create(button)
gui.F_Main.cmdNext.caption("Next")
gui.F_Main.cmdNext.visible(True)
gui.F_Main.cmdNext.size(855,375)
gui.F_Main.cmdNext.zorder(0)
gui.F_Main.cmdNext.position(8100,300)
gui.F_Main.cmdNext.enabled(True)
gui.F_Main.cmdNext.parent("frmlowerhalf")
gui.F_Main.cmdNext.fontname("Arial")
gui.F_Main.cmdNext.fontsize(8)
gui.F_Main.cmdNext.event(click,cmdnext_click)
gui.F_Main.cmdNext.defaultvalue("")
gui.F_Main.cmdNext.controlgroup(0)
gui.F_Main.cmdPrev.create(button)
gui.F_Main.cmdPrev.caption("Previous")
gui.F_Main.cmdPrev.visible(True)
gui.F_Main.cmdPrev.size(855,375)
gui.F_Main.cmdPrev.zorder(0)
gui.F_Main.cmdPrev.position(8100,800)
gui.F_Main.cmdPrev.enabled(True)
gui.F_Main.cmdPrev.parent("frmlowerhalf")
gui.F_Main.cmdPrev.fontname("Arial")
gui.F_Main.cmdPrev.fontsize(8)
gui.F_Main.cmdPrev.event(click,cmdprev_click)
gui.F_Main.cmdPrev.defaultvalue("")
gui.F_Main.cmdPrev.controlgroup(0)


Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
Variable.Global.sSettingsPath.Declare(String)
Variable.Global.sVersion.Declare(String)
Variable.Global.iRowCount.Declare(Long,0)
Variable.Global.bGoodPlList.Declare(Boolean,True)
Variable.Global.fProgBarValue.Declare(Float,0)
Variable.Global.sHeader.Declare(String,"Open Job Review")
Variable.Global.sOldValue.Declare(String)
Variable.Global.iOldLength.Declare(Long,0)
Variable.Global.iOldRow.Declare(Long,0)

Variable.UDT.uJobH.Define("JOB",String,JOB)
Variable.UDT.uJobH.Define("SUFFIX",String,SUFFIX)
Variable.UDT.uJobH.Define("PART",String,PART)
Variable.UDT.uJobH.Define("LOCATION",String,LOCATION)
Variable.UDT.uJobH.Define("PL",String,PRODUCT_LINE)
Variable.UDT.uJobH.Define("CUST_NAME",String,CUST_NAME)
Variable.UDT.uJobH.Define("FLAG_WO_PRTD",String,FLAG_WO_PRTD)
Variable.UDT.uJobH.Define("DATE_DUE",Date,DATE_DUE)
Variable.UDT.uJobH.Define("DESCRIPTION",String,DESCRIPTION)
Variable.UDT.uJobH.Define("NUM_HOURS",Float,NUM_HOURS)
Variable.UDT.uJobH.Define("WO_NOTE",String,WO_NOTE)
Variable.UDT.uJobH.Define("QTY_LEFT",Float,QTY_LEFT)
Variable.UDT.uJobH.Define("SCHEDULED_DUE_DATE",Date,SCHEDULED_DUE_DATE)
Variable.UDT.uJobH.Define("PRIORITY",String,PRIORITY)
Variable.UDT.uJobH.Define("CUSTOMER_PO",String,CUSTOMER_PO)
Variable.UDT.uJobH.Define("QTY_ORDER",Float,QTY_ORDER)
Variable.UDT.uJobH.Define("QTY_COMPLETED",Float,QTY_COMPLETED)
Variable.UDT.uJobH.Define("DATE_START",Date,DATE_START)
Variable.uGlobal.uJobH.Declare("uJobH")
Variable.Global.sSqlJobHeader.Declare(String)
Variable.Global.sSQLWC.Declare(String)
Variable.Global.sSQLRELDATE.Declare(String)
Variable.UDT.uRelDate.Define("JOB",String,JOB)
Variable.UDT.uRelDate.Define("SUFFIX",String,SUFFIX)
Variable.UDT.uRelDate.Define("REL_DATE",String,REL_DATE)
Variable.uGlobal.uRelDate.Declare("uRelDate")
Variable.UDT.uEstHours.Define("HOURS_ESTIMATED",Float,HOURS_ESTIMATED)
Variable.UDT.uEstHours.Define("JOB",String,JOB)
Variable.UDT.uEstHours.Define("SUFFIX",String,SUFFIX)
Variable.uGlobal.uEstHours.Declare("uEstHours")
Variable.Global.sSQLEst_Hours.Declare(String)
Variable.UDT.uGrid.Define("Print",String)
Variable.UDT.uGrid.Define("Released",String)
Variable.UDT.uGrid.Define("Job",String)
Variable.UDT.uGrid.Define("Suffix",String)
Variable.UDT.uGrid.Define("Part",String)
Variable.UDT.uGrid.Define("Loc",String)
Variable.UDT.uGrid.Define("Date_Due",Date)
Variable.UDT.uGrid.Define("Act_hours",Float)
Variable.UDT.uGrid.Define("Notes",String)
Variable.UDT.uGrid.Define("Row",Long)
Variable.UDT.uGrid.Define("Qty_Left",Float)
Variable.UDT.uGrid.Define("Date_Sched_Due",Date)
Variable.UDT.uGrid.Define("Qty_Order",Float)
Variable.UDT.uGrid.Define("Date_Start",Date)
Variable.UDT.uGrid.Define("Hold",String)
Variable.UDT.uGrid.Define("Lock",String)
Variable.UDT.uGrid.Define("MIssued",Float)
Variable.UDT.uGrid.Define("Est_Hours",Float)
Variable.UDT.uGrid.Define("SODate_Due",Date)
Variable.UDT.uGrid.Define("Est_Rem",Float)
Variable.UDT.uGrid.Define("Rev",String)
Variable.UDT.uGrid.Define("Rel_Date",String)
Variable.uGlobal.uGrid.Declare("uGrid")
Variable.UDT.uData.Define("ROW",LONG)
Variable.UDT.uData.Define("HOLD",String,HOLD)
Variable.UDT.uData.Define("LOCK",String,LOCK)
Variable.UDT.uData.Define("Print",String,PRINTED)
Variable.UDT.uData.Define("Released",String,RELEASED)
Variable.UDT.uData.Define("MISSUED",String,MISSUED)
Variable.UDT.uData.Define("Job",String,JOB)
Variable.UDT.uData.Define("Suffix",String,SUFFIX)
Variable.UDT.uData.Define("Part",String,PART)
Variable.UDT.uData.Define("REV",String)
Variable.UDT.uData.Define("Loc",String,LOCATION)
Variable.UDT.uData.Define("QTY_ORDER",FLOAT,QTY_ORDER)
Variable.UDT.uData.Define("QTY_LEFT",FLOAT,QTY_LEFT)
Variable.UDT.uData.Define("DATE_START",DATE,DATE_START)
Variable.UDT.uData.Define("WO_DUE_DATE",DATE,WO_DUE_DATE)
Variable.UDT.uData.Define("SCHEDULED_DUE_DATE",DATE,SCHEDULED_DUE_DATE)
Variable.UDT.uData.Define("EST_HOURS",FLOAT,EST_HOURS)
Variable.UDT.uData.Define("ACT_HOURS",Float,ACT_HOURS)
Variable.UDT.uData.Define("REM",FLOAT,REM)
Variable.UDT.uData.Define("WO_NOTE",String,WO_NOTE)
Variable.UDT.uData.Define("DATE_RELEASED",DATE,DATE_RELEASED)
Variable.UDT.uData.Define("SO_DUE_DATE",Date,SO_DUE_DATE)
Variable.UDT.uData.Define("SAMPLE",String,SAMPLE)
Variable.uGlobal.uData.Declare("uData")
Variable.Global.sSQLOper.Declare(String)
Variable.Global.bSort.Declare(Boolean,True)
Variable.Global.iCol.Declare(Long,0)
Variable.Global.bOptEdit.Declare(Boolean,False)
Variable.Global.iProgBarVal.Declare(Long,0)
Variable.Global.iProgBarTotalVal.Declare(Long,0)
Variable.Global.iRelStatus.Declare(Long,0)
Variable.Global.iMouseRowChk.Declare(Long,1)
Variable.Global.iMouseColChk.Declare(Long,1)
Variable.UDT.uJobLines.Define("Job",String,Job)
Variable.UDT.uJobLines.Define("Sfx",String,Sfx)
Variable.UDT.uJobLines.Define("Seq",Long,Seq)
Variable.UDT.uJobLines.Define("SeqType",Long,SeqType)
Variable.UDT.uJobLines.Define("ComplDate",String,ComplDate)
Variable.UDT.uJobLines.Define("SeqRes",String,SeqRes)
Variable.uGlobal.uJobLines.Declare("uJobLines")
Variable.Global.sSQLJobLines.Declare(String)
Variable.Global.iPageFrom.Declare(Long,0)
Variable.Global.iPageTo.Declare(Long,200)
Program.Sub.Preflight.End

Program.Sub.Main.Start
F.Intrinsic.Control.SetErrorHandler("Main_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Coded by RRC 09/30/2014
'Notes:
'     Dashboard type GAB Script that allows the user to see select Open Jobs
'     From the GAB script you are able to add notes to the individual work orders.
'     User in EDITWO group will be able to Open/Edit the WO

'Modified by WAW 05/23/2016
'SubBuildStyle_fgOpenJobs Add ?Sample? to column 1 and move everything else up by 1. Copy the styles from Hold.
'SubChangeGridStyle Within the for loop after the due date and sched date. Copied the if statement and check to see if column 1 = 1. If it is 1 then use GSGOverrideProperty on Job now column 7 and backcolor set to yellow.
'Moved all of the GetTextMatrix fields and GSGOverrideProperty?s up a column so they are in changing the correct field.
'SubRedoStyle Did the same thing as SubChangeGridStyle
'SubGenerate_sql Added IF(VJH.CUSTOMER_PO LIKE '%SAMPLE%',1,0) AS SAMPLE to the beginning of the sql statement
'Added SAMPLE to the udata UDT?s


'Set Program Version Number
V.Global.sVersion.Set("3652")

'Set Form as NOT Visible/Enabled until Ready
Gui.F_Main..Enabled(False)
Gui.F_Main..Visible(False)
Gui.F_Main..Position(0,0)

Gui.F_Main.cboPrtRel.AddItem("Printed",0)
Gui.F_Main.cboPrtRel.AddItem("Released",1)
Gui.F_Main.cboPrtRel.AddItem("Print/Rel",2)
Gui.F_Main.cboPrtRel.AddItem("No Print/No Rel",3)

'Check if the User is in EDITWO Group, to enable Edit options
F.Global.Security.IsInGroup(V.Caller.User,"EDITWO",V.Global.bOptEdit)

'Static Screen Setup
'****************************************************

Gui.F_Main.optView.Value("True")

'Refresh Button Setup
Gui.F_Main.cmdRefresh.FontSize(18)

'Filter Button Setup
Gui.F_Main.cmdFilter.FontSize(10)

'lblLoadMsg Setup
Gui.F_Main.lblLoadMsg.FontSize(14)
Gui.F_Main.lblLoadMsg.Alignment(2)
Gui.F_Main.lblLoadMsg.FontName("Arial Black")
Gui.F_Main.lblLoadMsg.ForeColor(V.Color.Blue)
Gui.F_Main.lblLoadMsg.Caption("If you want this scrtip to Load your Data Automatically upon Start, please check the 'Auto Load Data on Next Script Start' option below.  Otherwise, click the 'View/Refresh' button below to load your Data now.")


'Progress Bar Reset
Gui.F_Main.prgLoad.Value(0)
Gui.F_Main.prgLoad.Visible(False)


'****************************************************

F.Intrinsic.Control.CallSub("subScreen_Refresh")

'Make the Form Visible

Gui.F_Main..Enabled(True)
Gui.F_Main..Visible(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Main_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.Main.End

Program.Sub.E_F_Main_Resize.Start
F.Intrinsic.Control.SetErrorHandler("E_F_Main_Resize_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Sub used for Resizing/Moving Objects on the Form
'There is a Minimum/Maximum size of Form which it will not go beyond

'Declare Variables for Moving/Sizing Objects on Form
V.Local.iWTemp.Declare(Long,0)
V.Local.iHTemp.Declare(Long,0)
V.Local.iXTemp.Declare(Long,0)
V.Local.iX2Temp.Declare(Long,0)
V.Local.iYTemp.Declare(Long,0)
V.Local.iY2Temp.Declare(Long,0)

'Allow Horizontal Screen Size to Go Larger than 19710... but Not Less
Function.Intrinsic.Control.If(Variable.Screen.F_Main.Width,<,15360)
	Gui.F_Main..Size(15360,Variable.Screen.F_Main.Height)
Function.Intrinsic.Control.EndIf

'Allow Vertical Screen Size to Go Larger than 10605... but Not Less
Function.Intrinsic.Control.If(Variable.Screen.F_Main.Height,<,10605)
	Gui.F_Main..Size(Variable.Screen.F_Main.Width,10605)
Function.Intrinsic.Control.EndIf

'Resize fgOpenJobs (It Does Not Move)
F.Intrinsic.Math.sub(V.Screen.F_Main.Width,300,V.Local.iWTemp)
F.Intrinsic.Math.sub(V.Screen.F_Main.Height,2350,V.Local.iHTemp)
Gui.F_Main.fgOpenJobs.Size(V.Local.iWTemp,V.Local.iHTemp)

'Resize prgLoad (Progress Bar) The Width and Y Postition Changes, Not the Height or X Position
F.Intrinsic.Math.sub(V.Screen.F_Main.Width,1600,V.Local.iWTemp)
Gui.F_Main.prgLoad.Position(750,3000)
Gui.F_Main.prgLoad.Size(V.Local.iWTemp,800)

'The lblLoadMsg (Static Position)
F.Intrinsic.Math.Div(V.Screen.F_Main.Width,2,V.Local.iXTemp)
F.Intrinsic.Math.Div(V.Screen.F_Main!lblLoadMsg.Width,2,V.Local.iX2Temp)
F.Intrinsic.Math.Sub(V.Local.iXTemp,V.Local.iX2Temp,V.Local.iXTemp)
Gui.F_Main.lblLoadMsg.position(V.Local.iXTemp,2000)

'Move LowerHalf (It Does Not Resize) Keep it Center
F.Intrinsic.Math.Div(V.Screen.F_Main.Width,2,V.Local.iXTemp)
F.Intrinsic.Math.Div(V.Screen.F_Main!frmLowerHalf.Width,2,V.Local.iX2Temp)
F.Intrinsic.Math.Sub(V.Local.iXTemp,V.Local.iX2Temp,V.Local.iXTemp)
F.Intrinsic.Math.Sub(V.Screen.F_Main.Height,2340,V.local.iYTemp)
Gui.F_Main.frmLowerHalf.position(V.Local.iXTemp,V.Local.iYTemp)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("E_F_Main_Resize_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.E_F_Main_Resize.End

Program.Sub.subExit.Start
'The Exit Sub

F.Intrinsic.Control.End

Program.Sub.subExit.End

Program.Sub.subBuildStyles_fgOpenJobs.Start
F.Intrinsic.Control.SetErrorHandler("subBuildStyles_fgOpenJobs_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Define Build Styles for Flex Grid fgOpenJobs

'Define Number of Columns and Fixed Columns in Flex Grid
'Fixed Column for Row Number
'Gui.F_Main.fgOpenJobs.Cols(22)
Gui.F_Main.fgOpenJobs.Cols(23)
Gui.F_Main.fgOpenJobs.FixedCols(1)

'Temp Set Row Count to 2 (So that Column Header can be Defined)
'If No Data is Found Latter... Rows will Remain at 1 for the Fixed Header
Gui.F_Main.fgOpenJobs.Rows(2)
Gui.F_Main.fgOpenJobs.FixedRows(1)

'--------------------------CREATE BUILD STYLES FOR FLEX GRID (USED FOR EITHER PART OF THE IF STATEMENT)----------------------------

'**** STYLE 1(FirstLine)
'Row Number Column (Dynamic)
Gui.F_Main.fgOpenJobs.TextMatrix(0,0,"")
Gui.F_Main.fgOpenJobs.ColWidth(0,400)
Gui.F_Main.fgOpenJobs.BuildStyle(1,0,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,0,"Format","alignment",4)

'New sample column
Gui.F_Main.fgOpenJobs.TextMatrix(1,0,"Sample")
Gui.F_Main.fgOpenJobs.ColWidth(1,600)
Gui.F_Main.fgOpenJobs.BuildStyle(1,1,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,1,"Format","alignment",4)

'Hold
Gui.F_Main.fgOpenJobs.TextMatrix(2,0,"Hold")
Gui.F_Main.fgOpenJobs.ColWidth(2,500)
Gui.F_Main.fgOpenJobs.BuildStyle(1,2,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,2,"Format","alignment",4)

'Lock
Gui.F_Main.fgOpenJobs.TextMatrix(3,0,"Lock")
Gui.F_Main.fgOpenJobs.ColWidth(3,500)
Gui.F_Main.fgOpenJobs.BuildStyle(1,3,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,3,"Format","alignment",4)

'Printed
Gui.F_Main.fgOpenJobs.TextMatrix(4,0,"Printed")
Gui.F_Main.fgOpenJobs.ColWidth(4,700)
Gui.F_Main.fgOpenJobs.BuildStyle(1,4,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,4,"Format","alignment",4)

'Release
Gui.F_Main.fgOpenJobs.TextMatrix(5,0,"Release")
Gui.F_Main.fgOpenJobs.ColWidth(5,800)
Gui.F_Main.fgOpenJobs.BuildStyle(1,5,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,5,"Format","alignment",4)

'M Issued
Gui.F_Main.fgOpenJobs.TextMatrix(6,0,"M Issued")
Gui.F_Main.fgOpenJobs.ColWidth(6,900)
Gui.F_Main.fgOpenJobs.BuildStyle(1,6,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,6,"Format","alignment",4)

'Job
Gui.F_Main.fgOpenJobs.TextMatrix(7,0,"Job")
Gui.F_Main.fgOpenJobs.ColWidth(7,800)
Gui.F_Main.fgOpenJobs.BuildStyle(1,7,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,7,"Format","alignment",4)

'Suffix
Gui.F_Main.fgOpenJobs.TextMatrix(8,0,"Suffix")
Gui.F_Main.fgOpenJobs.ColWidth(8,600)
Gui.F_Main.fgOpenJobs.BuildStyle(1,8,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,8,"Format","alignment",4)

'Part (Linked to Supply and Demand)
Gui.F_Main.fgOpenJobs.TextMatrix(9,0,"Part")
Gui.F_Main.fgOpenJobs.ColWidth(9,3500)
Gui.F_Main.fgOpenJobs.BuildStyle(1,9,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,9,"Format","alignment",4)

'Rev
Gui.F_Main.fgOpenJobs.TextMatrix(10,0,"Rev")
Gui.F_Main.fgOpenJobs.ColWidth(10,1000)
Gui.F_Main.fgOpenJobs.BuildStyle(1,10,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,10,"Format","alignment",4)

'Location
Gui.F_Main.fgOpenJobs.TextMatrix(11,0,"Loc")
Gui.F_Main.fgOpenJobs.ColWidth(11,600)
Gui.F_Main.fgOpenJobs.BuildStyle(1,11,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,11,"Format","alignment",4)

'WO Qty
Gui.F_Main.fgOpenJobs.TextMatrix(12,0,"WO Qty")
Gui.F_Main.fgOpenJobs.ColWidth(12,900)
Gui.F_Main.fgOpenJobs.BuildStyle(1,12,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,12,"Format","alignment",4)

'Qty Rem
Gui.F_Main.fgOpenJobs.TextMatrix(13,0,"Qty Rem")
Gui.F_Main.fgOpenJobs.ColWidth(13,900)
Gui.F_Main.fgOpenJobs.BuildStyle(1,13,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,13,"Format","alignment",4)

'1st Labor Start Date
Gui.F_Main.fgOpenJobs.TextMatrix(14,0,"WO Start Dt")
Gui.F_Main.fgOpenJobs.ColWidth(14,1000)
Gui.F_Main.fgOpenJobs.BuildStyle(1,14,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,14,"Format","alignment",4)

'WO Due Date
Gui.F_Main.fgOpenJobs.TextMatrix(15,0,"WO Due Date")
Gui.F_Main.fgOpenJobs.ColWidth(15,1000)
Gui.F_Main.fgOpenJobs.BuildStyle(1,15,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,15,"Format","alignment",4)

'SO Due Date
Gui.F_Main.fgOpenJobs.TextMatrix(16,0,"SO Due Date")
Gui.F_Main.fgOpenJobs.ColWidth(16,1200)
Gui.F_Main.fgOpenJobs.BuildStyle(1,16,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,16,"Format","alignment",4)

'Scheduled Date
Gui.F_Main.fgOpenJobs.TextMatrix(17,0,"Scheduled Dt")
Gui.F_Main.fgOpenJobs.ColWidth(17,1300)
Gui.F_Main.fgOpenJobs.BuildStyle(1,17,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,17,"Format","alignment",4)

'Est Total Hours
Gui.F_Main.fgOpenJobs.TextMatrix(18,0,"Est Hours")
Gui.F_Main.fgOpenJobs.ColWidth(18,900)
Gui.F_Main.fgOpenJobs.BuildStyle(1,18,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,18,"Format","alignment",4)

'Act Hours
Gui.F_Main.fgOpenJobs.TextMatrix(19,0,"Act Hours")
Gui.F_Main.fgOpenJobs.ColWidth(19,900)
Gui.F_Main.fgOpenJobs.BuildStyle(1,19,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,19,"Format","alignment",4)

'Est Remaining Hours
Gui.F_Main.fgOpenJobs.TextMatrix(20,0,"Est Rem Hours")
Gui.F_Main.fgOpenJobs.ColWidth(20,1200)
Gui.F_Main.fgOpenJobs.BuildStyle(1,20,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,20,"Format","alignment",4)

'Notes (Work Order Header User_2 Field)
Gui.F_Main.fgOpenJobs.TextMatrix(21,0,"Work Order Note (70 Characters)")
Gui.F_Main.fgOpenJobs.ColWidth(21,3000)
Gui.F_Main.fgOpenJobs.BuildStyle(1,21,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,21,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(1,21,"Color","Back",V.Color.Pink)

'Release Date
Gui.F_Main.fgOpenJobs.TextMatrix(22,0,"Release Dt")
Gui.F_Main.fgOpenJobs.ColWidth(22,1200)
Gui.F_Main.fgOpenJobs.BuildStyle(1,22,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(1,22,"Format","alignment",4)

'**** STYLE (2)(View)
'Row Number Column (Dynamic)
Gui.F_Main.fgOpenJobs.BuildStyle(2,0,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,0,"Format","alignment",4)

'Sample
Gui.F_Main.fgOpenJobs.BuildStyle(2,1,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(2,1,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,1,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,1,"Format","alignment",1)

'Hold
Gui.F_Main.fgOpenJobs.BuildStyle(2,2,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(2,2,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,2,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,2,"Format","alignment",1)

'Lock
Gui.F_Main.fgOpenJobs.BuildStyle(2,3,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(2,3,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,3,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(2,3,"Color","Back",V.Color.White)

'Printed
Gui.F_Main.fgOpenJobs.BuildStyle(2,4,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(2,4,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,4,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,4,"Format","alignment",1)

'Release
Gui.F_Main.fgOpenJobs.BuildStyle(2,5,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(2,5,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,5,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(2,5,"Color","Back",V.Color.White)



'M Issued
Gui.F_Main.fgOpenJobs.BuildStyle(2,6,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(2,6,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,6,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(2,6,"Color","Back",V.Color.White)

'Job
Gui.F_Main.fgOpenJobs.BuildStyle(2,7,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,7,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,7,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(2,7,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,7,"Color","Fore",16711680)

'Suffix
Gui.F_Main.fgOpenJobs.BuildStyle(2,8,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,8,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,8,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(2,8,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,8,"Color","Fore",16711680)

'Part (Linked to Supply and Demand)
Gui.F_Main.fgOpenJobs.BuildStyle(2,9,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,9,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(2,9,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,9,"Color","Fore",16711680)
Gui.F_Main.fgOpenJobs.BuildStyle(2,9,"Color","Back",V.Color.White)

'Rev
Gui.F_Main.fgOpenJobs.BuildStyle(2,10,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,10,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,10,"Format","alignment",4)

'Location
Gui.F_Main.fgOpenJobs.BuildStyle(2,11,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,11,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,11,"Format","alignment",4)

'WO Qty
Gui.F_Main.fgOpenJobs.BuildStyle(2,12,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,12,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,12,"Format","alignment",4)

'Qty Rem
Gui.F_Main.fgOpenJobs.BuildStyle(2,13,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,13,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(2,13,"Color","Back",V.Color.White)

'1st Labor Start Date
Gui.F_Main.fgOpenJobs.BuildStyle(2,14,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,14,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(2,14,"Format","Mask","mm/dd/yyyy")
Gui.F_Main.fgOpenJobs.BuildStyle(2,14,"Color","Back",V.Color.White)

'WO Due Date
Gui.F_Main.fgOpenJobs.BuildStyle(2,15,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,15,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,15,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(2,15,"Format","Mask","mm/dd/yyyy")

'SO Due Date
Gui.F_Main.fgOpenJobs.BuildStyle(2,16,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,16,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,16,"Color","Fore",16711680)
Gui.F_Main.fgOpenJobs.BuildStyle(2,16,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,16,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(2,16,"Format","Mask","mm/dd/yyyy")

'Scheduled Date
Gui.F_Main.fgOpenJobs.BuildStyle(2,17,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,17,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,17,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(2,17,"Format","Mask","mm/dd/yyyy")

'Est Total Hours
Gui.F_Main.fgOpenJobs.BuildStyle(2,18,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,18,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,18,"Format","alignment",4)

'Act Hours
Gui.F_Main.fgOpenJobs.BuildStyle(2,19,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,19,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,19,"Format","alignment",4)

'Est Rem Hours
Gui.F_Main.fgOpenJobs.BuildStyle(2,20,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,20,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,20,"Format","alignment",4)

'Notes (Work Order Header User_2 Field)
Gui.F_Main.fgOpenJobs.BuildStyle(2,21,"type","locked",False)
Gui.F_Main.fgOpenJobs.BuildStyle(2,21,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(2,21,"Color","Back",V.Color.Pink)

'Release Date
Gui.F_Main.fgOpenJobs.BuildStyle(2,22,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(2,22,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(2,22,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(2,22,"Format","Mask","mm/dd/yyyy")

'**** STYLE (3)(View past due)
'Row Number Column (Dynamic)
Gui.F_Main.fgOpenJobs.BuildStyle(3,0,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,0,"Format","alignment",4)

'Sample
Gui.F_Main.fgOpenJobs.BuildStyle(3,1,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(3,1,"type","locked",True)
Gui.F_Main.fgOpenJobs.buildstyle(3,1,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,1,"Format","alignment",1)

'Hold
Gui.F_Main.fgOpenJobs.BuildStyle(3,2,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(3,2,"type","locked",True)
Gui.F_Main.fgOpenJobs.buildstyle(3,2,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,2,"Format","alignment",1)

'Lock
Gui.F_Main.fgOpenJobs.BuildStyle(3,3,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(3,3,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,3,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(3,3,"Color","Back",V.Color.LtGray)

'Printed
Gui.F_Main.fgOpenJobs.BuildStyle(3,4,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(3,4,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,4,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,4,"Format","alignment",1)

'Release
Gui.F_Main.fgOpenJobs.BuildStyle(3,5,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(3,5,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,5,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(3,5,"Color","Back",V.Color.LtGray)



'M Issued
Gui.F_Main.fgOpenJobs.BuildStyle(3,6,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(3,6,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,6,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(3,6,"Color","Back",V.Color.LtGray)

'Job
Gui.F_Main.fgOpenJobs.BuildStyle(3,7,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,7,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,7,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(3,7,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,7,"Color","Fore",16711680)

'Suffix
Gui.F_Main.fgOpenJobs.BuildStyle(3,8,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,8,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,8,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(3,8,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,8,"Color","Fore",16711680)

'Part (Linked to Supply and Demand)
Gui.F_Main.fgOpenJobs.BuildStyle(3,9,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,9,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(3,9,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,9,"Color","Fore",16711680)
Gui.F_Main.fgOpenJobs.BuildStyle(3,9,"Color","Back",V.Color.LtGray)

'Rev
Gui.F_Main.fgOpenJobs.BuildStyle(3,10,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,10,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,10,"Format","alignment",4)

'Location
Gui.F_Main.fgOpenJobs.BuildStyle(3,11,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,11,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,11,"Format","alignment",4)

'WO Qty
Gui.F_Main.fgOpenJobs.BuildStyle(3,12,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,12,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,12,"Format","alignment",4)

'Qty Rem
Gui.F_Main.fgOpenJobs.BuildStyle(3,13,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,13,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(3,13,"Color","Back",V.Color.LtGray)

'1st Labor Start Date
Gui.F_Main.fgOpenJobs.BuildStyle(3,14,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,14,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(3,14,"Format","Mask","mm/dd/yyyy")
Gui.F_Main.fgOpenJobs.BuildStyle(3,14,"Color","Back",V.Color.LtGray)

'WO Due Date
Gui.F_Main.fgOpenJobs.BuildStyle(3,15,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,15,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,15,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(3,15,"Format","Mask","mm/dd/yyyy")

'SO Due Date
Gui.F_Main.fgOpenJobs.BuildStyle(3,16,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,16,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,16,"Color","Fore",16711680)
Gui.F_Main.fgOpenJobs.BuildStyle(3,16,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,16,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(3,16,"Format","Mask","mm/dd/yyyy")

'Scheduled Date
Gui.F_Main.fgOpenJobs.BuildStyle(3,17,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,17,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,17,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(3,17,"Format","Mask","mm/dd/yyyy")

'Est Total Hours
Gui.F_Main.fgOpenJobs.BuildStyle(3,18,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,18,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,18,"Format","alignment",4)

'Act Hours
Gui.F_Main.fgOpenJobs.BuildStyle(3,19,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,19,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,19,"Format","alignment",4)

'Est Rem Hours
Gui.F_Main.fgOpenJobs.BuildStyle(3,20,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,20,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,20,"Format","alignment",4)

'Notes (Work Order Header User_2 Field)
Gui.F_Main.fgOpenJobs.BuildStyle(3,21,"type","locked",False)
Gui.F_Main.fgOpenJobs.BuildStyle(3,21,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(3,21,"Color","Back",V.Color.Pink)

'Release Date
Gui.F_Main.fgOpenJobs.BuildStyle(3,22,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(3,22,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(3,22,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(3,22,"Format","Mask","mm/dd/yyyy")

'**** STYLE (4)(Edit)
'Row Number Column (Dynamic)
Gui.F_Main.fgOpenJobs.BuildStyle(4,0,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,0,"Format","alignment",4)

'Sample
Gui.F_Main.fgOpenJobs.BuildStyle(4,1,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(4,1,"type","locked",False)
Gui.F_Main.fgOpenJobs.buildstyle(4,1,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,1,"Format","alignment",1)

'Hold
Gui.F_Main.fgOpenJobs.BuildStyle(4,2,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(4,2,"type","locked",False)
Gui.F_Main.fgOpenJobs.buildstyle(4,2,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,2,"Format","alignment",1)

'Lock
Gui.F_Main.fgOpenJobs.BuildStyle(4,3,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(4,3,"type","locked",False)
Gui.F_Main.fgOpenJobs.BuildStyle(4,3,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(4,3,"Color","Back",V.Color.White)

'Printed
Gui.F_Main.fgOpenJobs.BuildStyle(4,4,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(4,4,"type","locked",False)
Gui.F_Main.fgOpenJobs.BuildStyle(4,4,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,4,"Format","alignment",1)

'Release
Gui.F_Main.fgOpenJobs.BuildStyle(4,5,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(4,5,"type","locked",False)
Gui.F_Main.fgOpenJobs.BuildStyle(4,5,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(4,5,"Color","Back",V.Color.White)



'M Issued
Gui.F_Main.fgOpenJobs.BuildStyle(4,6,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(4,6,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,6,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(4,6,"Color","Back",V.Color.White)

'Job
Gui.F_Main.fgOpenJobs.BuildStyle(4,7,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,7,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,7,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(4,7,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,7,"Color","Fore",16711680)

'Suffix
Gui.F_Main.fgOpenJobs.BuildStyle(4,8,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,8,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,8,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(4,8,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,8,"Color","Fore",16711680)

'Part (Linked to Supply and Demand)
Gui.F_Main.fgOpenJobs.BuildStyle(4,9,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,9,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(4,9,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,9,"Color","Fore",16711680)
Gui.F_Main.fgOpenJobs.BuildStyle(4,9,"Color","Back",V.Color.White)

'Rev
Gui.F_Main.fgOpenJobs.BuildStyle(4,10,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,10,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,10,"Format","alignment",4)

'Location
Gui.F_Main.fgOpenJobs.BuildStyle(4,11,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,11,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,11,"Format","alignment",4)

'WO Qty
Gui.F_Main.fgOpenJobs.BuildStyle(4,12,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,12,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,12,"Format","alignment",4)

'Qty Rem
Gui.F_Main.fgOpenJobs.BuildStyle(4,13,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,13,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(4,13,"Color","Back",V.Color.White)

'1st Labor Start Date
Gui.F_Main.fgOpenJobs.BuildStyle(4,14,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,14,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(4,14,"Format","Mask","mm/dd/yyyy")
Gui.F_Main.fgOpenJobs.BuildStyle(4,14,"Color","Back",V.Color.White)

'WO Due Date
Gui.F_Main.fgOpenJobs.BuildStyle(4,15,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,15,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,15,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(4,15,"Format","Mask","mm/dd/yyyy")

'SO Due Date
Gui.F_Main.fgOpenJobs.BuildStyle(4,16,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,16,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,16,"Color","Fore",16711680)
Gui.F_Main.fgOpenJobs.BuildStyle(4,16,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,16,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(4,16,"Format","Mask","mm/dd/yyyy")

'Scheduled Date
Gui.F_Main.fgOpenJobs.BuildStyle(4,17,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,17,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,17,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(4,17,"Format","Mask","mm/dd/yyyy")

'Est Total Hours
Gui.F_Main.fgOpenJobs.BuildStyle(4,18,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,18,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,18,"Format","alignment",4)

'Act Hours
Gui.F_Main.fgOpenJobs.BuildStyle(4,19,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,19,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,19,"Format","alignment",4)

'Est Rem Hours
Gui.F_Main.fgOpenJobs.BuildStyle(4,20,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,20,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,20,"Format","alignment",4)

'Notes (Work Order Header User_2 Field)
Gui.F_Main.fgOpenJobs.BuildStyle(4,21,"type","locked",False)
Gui.F_Main.fgOpenJobs.BuildStyle(4,21,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(4,21,"Color","Back",V.Color.Pink)

'Release Date
Gui.F_Main.fgOpenJobs.BuildStyle(4,22,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(4,22,"Color","Back",V.Color.White)
Gui.F_Main.fgOpenJobs.BuildStyle(4,22,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(4,22,"Format","Mask","mm/dd/yyyy")

'**** STYLE (5)(Edit past due)
'Row Number Column (Dynamic)


Gui.F_Main.fgOpenJobs.BuildStyle(5,0,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,0,"Format","alignment",4)

'Sample
Gui.F_Main.fgOpenJobs.BuildStyle(5,1,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(5,1,"type","locked",False)
Gui.F_Main.fgOpenJobs.buildstyle(5,1,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,1,"Format","alignment",1)

'Hold
Gui.F_Main.fgOpenJobs.BuildStyle(5,2,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(5,2,"type","locked",False)
Gui.F_Main.fgOpenJobs.buildstyle(5,2,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,2,"Format","alignment",1)

'Lock
Gui.F_Main.fgOpenJobs.BuildStyle(5,3,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(5,3,"type","locked",False)
Gui.F_Main.fgOpenJobs.BuildStyle(5,3,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(5,3,"Color","Back",V.Color.LtGray)

'Printed
Gui.F_Main.fgOpenJobs.BuildStyle(5,4,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(5,4,"type","locked",False)
Gui.F_Main.fgOpenJobs.BuildStyle(5,4,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,4,"Format","alignment",1)

'Release
Gui.F_Main.fgOpenJobs.BuildStyle(5,5,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(5,5,"type","locked",False)
Gui.F_Main.fgOpenJobs.BuildStyle(5,5,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(5,5,"Color","Back",V.Color.LtGray)



'M Issued
Gui.F_Main.fgOpenJobs.BuildStyle(5,6,"Type","Checkbox",0)
Gui.F_Main.fgOpenJobs.BuildStyle(5,6,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,6,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(5,6,"Color","Back",V.Color.LtGray)

'Job
Gui.F_Main.fgOpenJobs.BuildStyle(5,7,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,7,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,7,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(5,7,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,7,"Color","Fore",16711680)

'Suffix
Gui.F_Main.fgOpenJobs.BuildStyle(5,8,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,8,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,8,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(5,8,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,8,"Color","Fore",16711680)

'Part (Linked to Supply and Demand)
Gui.F_Main.fgOpenJobs.BuildStyle(5,9,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,9,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(5,9,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,9,"Color","Fore",16711680)
Gui.F_Main.fgOpenJobs.BuildStyle(5,9,"Color","Back",V.Color.LtGray)

'Rev
Gui.F_Main.fgOpenJobs.BuildStyle(5,10,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,10,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,10,"Format","alignment",4)

'Location
Gui.F_Main.fgOpenJobs.BuildStyle(5,11,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,11,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,11,"Format","alignment",4)

'WO Qty
Gui.F_Main.fgOpenJobs.BuildStyle(5,12,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,12,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,12,"Format","alignment",4)

'Qty Rem
Gui.F_Main.fgOpenJobs.BuildStyle(5,13,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,13,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(5,13,"Color","Back",V.Color.LtGray)

'1st Labor Start Date
Gui.F_Main.fgOpenJobs.BuildStyle(5,14,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,14,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(5,14,"Format","Mask","mm/dd/yyyy")
Gui.F_Main.fgOpenJobs.BuildStyle(5,14,"Color","Back",V.Color.LtGray)

'WO Due Date
Gui.F_Main.fgOpenJobs.BuildStyle(5,15,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,15,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,15,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(5,15,"Format","Mask","mm/dd/yyyy")

'SO Due Date
Gui.F_Main.fgOpenJobs.BuildStyle(5,16,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,16,"fontstyle","underline",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,16,"Color","Fore",16711680)
Gui.F_Main.fgOpenJobs.BuildStyle(5,16,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,16,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(5,16,"Format","Mask","mm/dd/yyyy")

'Scheduled Date
Gui.F_Main.fgOpenJobs.BuildStyle(5,17,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,17,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,17,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(5,17,"Format","Mask","mm/dd/yyyy")

'Est Total Hours
Gui.F_Main.fgOpenJobs.BuildStyle(5,18,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,18,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,18,"Format","alignment",4)

'Act Hours
Gui.F_Main.fgOpenJobs.BuildStyle(5,19,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,19,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,19,"Format","alignment",4)

'Est Rem Hours
Gui.F_Main.fgOpenJobs.BuildStyle(5,20,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,20,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,20,"Format","alignment",4)

'Notes (Work Order Header User_2 Field)
Gui.F_Main.fgOpenJobs.BuildStyle(5,21,"type","locked",False)
Gui.F_Main.fgOpenJobs.BuildStyle(5,21,"Format","alignment",1)
Gui.F_Main.fgOpenJobs.BuildStyle(5,21,"Color","Back",V.Color.Pink)

'Release Date
Gui.F_Main.fgOpenJobs.BuildStyle(5,22,"type","locked",True)
Gui.F_Main.fgOpenJobs.BuildStyle(5,22,"Color","Back",V.Color.LtGray)
Gui.F_Main.fgOpenJobs.BuildStyle(5,22,"Format","alignment",4)
Gui.F_Main.fgOpenJobs.BuildStyle(5,22,"Format","Mask","mm/dd/yyyy")

'Cell selection moves Down after hitting enter...
Gui.F_Main.fgOpenJobs.SetProperty("Enter",0)
Gui.F_Main.fgOpenJobs.ApplyStyle(0,1)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("subBuildStyles_fgOpenJobs_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf


Program.Sub.subBuildStyles_fgOpenJobs.End

Program.Sub.subGenerate_Sql.Start
F.Intrinsic.Control.SetErrorHandler("subGenerate_Sql_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Define SQL Statements for Pulling Data from Global Shop

'Define Local Variables
V.Local.iCount.Declare(Long)

'SELECT
V.Global.sSqlJobHeader.Set("SELECT  IF(VJH.FLAG_HOLD = 'Y',1,0) AS HOLD, IF(VJH.JOB_LOCKED = 'Y',1,0) AS LOCK, IF(VJH.CUSTOMER_PO LIKE '%SAMPLE%',1,0) AS SAMPLE,  IF(VJH.FLAG_WO_PRTD = 'Y' OR VJH.FLAG_WO_PRTD = 'R',1,0) AS PRINTED,")
F.Intrinsic.String.Concat(V.Global.sSqlJobHeader," IF(VJH.FLAG_WO_PRTD = 'R' OR VJH.FLAG_WO_PRTD = 'X',1,0) AS RELEASED, (SELECT IF(COUNT(FLAG_CLOSED) > 0,0,1) FROM V_JOB_OPERATIONS WHERE LMO = 'M' AND SEQ < '900000' AND FLAG_CLOSED <> 'Y' AND JOB = VJH.JOB AND SUFFIX = VJH.SUFFIX) AS MISSUED, ",V.Global.sSqlJobHeader)
F.Intrinsic.String.Concat(V.Global.sSqlJobHeader," VJH.JOB, VJH.SUFFIX, VJH.PART, VJH.LOCATION, VJH.QTY_ORDER, (VJH.QTY_ORDER - VJH.QTY_COMPLETED) AS QTY_LEFT, (SELECT TOP 1 DATE_START FROM V_JOB_OPERATIONS WHERE LMO = 'L' AND JOB = VJH.JOB AND SUFFIX = VJH.SUFFIX) AS DATE_START, ",V.Global.sSqlJobHeader)
F.Intrinsic.String.Concat(V.Global.sSqlJobHeader," VJH.DATE_DUE AS WO_DUE_DATE, VOL.DATE_ITEM_PROM AS SO_DUE_DATE, VJH.SCHEDULED_DUE_DATE, ",V.Global.sSqlJobHeader)
F.Intrinsic.String.Concat(V.Global.sSqlJobHeader," (SELECT SUM(HOURS_ESTIMATED) FROM V_JOB_OPERATIONS WHERE LMO = 'L' AND JOB = VJH.JOB AND SUFFIX = VJH.SUFFIX AND SEQ < '900000') AS EST_HOURS, (SELECT SUM(HOURS_ACTUAL) FROM V_JOB_OPERATIONS WHERE LMO = 'L' AND JOB = VJH.JOB AND SUFFIX = VJH.SUFFIX AND SEQ < '900000') AS ACT_HOURS, ",V.Global.sSqlJobHeader)
F.Intrinsic.String.Concat(V.Global.sSqlJobHeader," (SELECT ISNULL(SUM(IF((HOURS_ESTIMATED - HOURS_ACTUAL) < 0,0,HOURS_ESTIMATED - HOURS_ACTUAL)) ,0) FROM V_JOB_OPERATIONS WHERE LMO = 'L' AND FLAG_CLOSED <> 'Y' AND SEQ < '900000' AND JOB = VJH.JOB AND SUFFIX = VJH.SUFFIX) AS REM, VWUF.USER_6 AS WO_NOTE, VJH.DATE_RELEASED ",V.Global.sSqlJobHeader)
'FROM
F.Intrinsic.String.Concat(V.Global.sSqlJobHeader," FROM V_JOB_HEADER AS VJH  ",V.Global.sSqlJobHeader)
F.Intrinsic.String.Concat(V.Global.sSqlJobHeader," LEFT JOIN V_ORDER_HEADER AS VOH ON VJH.SALES_ORDER = VOH.ORDER_NO ",V.Global.sSqlJobHeader)
F.Intrinsic.String.Concat(V.Global.sSqlJobHeader," LEFT JOIN V_WO_USER_FLDS AS VWUF ON VJH.JOB = VWUF.JOB AND VJH.SUFFIX = VWUF.SUFFIX ",V.Global.sSqlJobHeader)
F.Intrinsic.String.Concat(V.Global.sSqlJobHeader," LEFT JOIN V_ORDER_LINES AS VOL ON VJH.SALES_ORDER = VOL.ORDER_NO AND VOL.RECORD_NO = (VJH.SALES_ORDER_LINE + '0')",V.Global.sSqlJobHeader)
'WHERE
F.Intrinsic.String.Concat(V.Global.sSqlJobHeader," WHERE VJH.DATE_CLOSED = '1900-01-01' ",V.Global.sSqlJobHeader)
'GROUP BY
F.Intrinsic.String.Concat(V.Global.sSqlJobHeader," GROUP BY HOLD, JOB, SUFFIX, PART, LOCATION, QTY_ORDER, QTY_COMPLETED, USER_6 ORDER BY WO_DUE_DATE ",V.Global.sSqlJobHeader)


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("subGenerate_Sql_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.subGenerate_Sql.End

Program.Sub.E_cmdExportExcel_Click.Start
F.Intrinsic.Control.SetErrorHandler("E_cmdExportExcel_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Export Flex Grid to Microsoft Excel

'Set Export Type to 1 for Excel
F.Intrinsic.Control.CallSub("subExport_fgOpenJobs","iExportType",1)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("E_cmdExportExcel_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.E_cmdExportExcel_Click.End

Program.Sub.E_cmdExportOO_Click.Start
F.Intrinsic.Control.SetErrorHandler("E_cmdExportOO_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Export Flex Grid to Open Office

'Set Export Type to 0 for Open Office
F.Intrinsic.Control.CallSub("subExport_fgOpenJobs","iExportType",0)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("E_cmdExportOO_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.E_cmdExportOO_Click.End

Program.Sub.subExport_fgOpenJobs.Start
F.Intrinsic.Control.SetErrorHandler("subExport_fgOpenJobs_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Sub used to Export the Flex Grid to either Excel or Open Office Depending on what Button the User Presses

'Declare Local Variable for Storing Save Path
V.Local.sFPath.Declare(String)
V.Local.sFPath.Set("")
V.Local.sMessage.Declare(String)
V.Local.iResponse.Declare(Long)
V.Local.iHandle.Declare(Long)
V.Local.iHandle.Set(0)
V.Local.iExportType.Declare(Long,-1)

'Load Passed iExportType Variable
V.Local.iExportType.Set(V.Args.iExportType)

'Check to see if Data is available to Export
F.Intrinsic.Control.If(V.Global.iRowCount,=<,0)
	'No Data to Export... Stop
	F.Intrinsic.UI.Msgbox("Nothing To Export","Nothing To Export")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf

'Display the Save Dialog
F.Intrinsic.UI.ShowSaveFileDialog("","xls|*.xls",,V.Local.sFPath)

'If User did not hit the Cancel button on the Save File Dialog, then Attempt to Export/Save the File
F.Intrinsic.Control.If(V.Local.sFPath,<>,"***CANCEL***")
	'Path NOT Blank (User did Not Cancel the Save)

	'Disable Flex Grid During Save
	'Lock the GUI During Save
	Gui.F_Main..Enabled(False)
	Gui.F_Main.fgOpenJobs.Visible(False)

	'Try To Save the File
	Gui.F_Main.lblLoadMsg.Caption("Saving....  This may take up to a minute depending on the amount of Data in the grid.  Please be patient...")
	Gui.F_Main.lblLoadMsg.Visible(true)
	Gui.F_Main.fgOpenJobs.Export(V.Local.sFPath,V.Local.iExportType)
	Gui.F_Main.lblLoadMsg.Visible(False)

	'File Saved Successfully
	'Create Message to Display
	'Ask user if they want to Open the File NOW?
	F.Intrinsic.String.Concat("The data was exported successfully to:",V.Ambient.NewLine,V.local.sFPath,V.ambient.newline,V.ambient.newline,"Do you want to open this file Now?",V.Local.sMessage)
	F.Intrinsic.UI.Msgbox(V.Local.sMessage,"File Saved Successfully",4,V.Local.iResponse)

	'Responses
	'6 = YES
	'7 = NO

	F.Intrinsic.Control.If(V.Local.iResponse,=,6)
		'User Said YES
		'Try to Open the File
		F.Intrinsic.Task.ShellExec(V.Local.iHandle,"open",V.Local.sFPath,,,0)
	F.Intrinsic.Control.EndIf

	'Re-Enable the Flex Grid after Save
	'UnLock the GUI After Save
	Gui.F_Main..Enabled(True)
	Gui.F_Main.fgOpenJobs.Visible(True)

F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("subExport_fgOpenJobs_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.subExport_fgOpenJobs.End

Program.Sub.E_cmdRefresh_Click.Start
F.Intrinsic.Control.SetErrorHandler("E_cmdRefresh_Click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Refresh Button Clicked

'Call the Screen Refresh Sub
F.Intrinsic.control.CallSub("subScreen_Refresh")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("E_cmdRefresh_Click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.E_cmdRefresh_Click.End

Program.Sub.subScreen_Refresh.Start
F.Intrinsic.Control.SetErrorHandler("subScreen_Refresh_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

V.Local.bEditGrp.Declare(Boolean)

'Check if the User is in EDIT Group, to enable the Edit button to edit SO
F.Global.Security.IsInGroup(V.Caller.User,"EDITWO",V.Local.bEditGrp)
F.Intrinsic.Control.If(V.Local.bEditGrp,=,"False")
	Gui.F_Main.optEdit.Enabled(0)
F.Intrinsic.Control.Else
	Gui.F_Main.optEdit.Enabled(1)
F.Intrinsic.Control.EndIf

'Sub Used to Refresh the Screen (the Grid)

'Disbale lblLoadMsg
Gui.F_Main.lblLoadMsg.Visible(False)

'Disable the Flex Grid while loading...
Gui.F_Main.fgOpenJobs.Enabled(False)
Gui.F_Main.fgOpenJobs.Visible(False)

'Disable the GUI
Gui.F_Main..Enabled(True)

'Reset Progress Load Bar
Gui.F_Main.prgLoad.Value(1)
Gui.F_Main.prgLoad.Visible(True)

'Clear Refresh Msg while Loading
Gui.F_Main..Caption(V.Global.sHeader)

'Make GUI Visible (if its not Already)
Gui.F_Main..Visible(True)

'Generate SQL Statements for Pulling Data (Based on Current Settings Selected on the Form)
F.Intrinsic.Control.CallSub("subGenerate_Sql")

'Load BuildStyles for fgOpenJobs Flex Grid
F.Intrinsic.Control.CallSub("subBuildStyles_fgOpenJobs")

'Load Data into fgOpenJobs Flex Grid
F.Intrinsic.Control.CallSub("subLoad_fgOpenJobs")

'Uncheck Filters
Gui.F_Main.chkPrtRel.Value(0)
Gui.F_Main.chkLoc.Value(0)
Gui.F_Main.chkPL.Value(0)

'Re-Enable Flex Grid and GUI
Gui.F_Main.prgLoad.Visible(False)
Gui.F_Main.fgOpenJobs.Visible(True)
Gui.F_Main.fgOpenJobs.Enabled(True)
Gui.F_Main..Enabled(True)

'Set Focus on cmdView button after Initial Load
Gui.F_Main.cmdRefresh.SetFocus

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("subScreen_Refresh_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.subScreen_Refresh.End

Program.Sub.subGenerate_RowNumbers.Start
F.Intrinsic.Control.SetErrorHandler("subGenerate_RowNumbers_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Declare Local Variable
V.Local.iCount.Declare(Long)
V.Local.iRow.Declare(Long)

F.Intrinsic.Control.for(V.Local.iCount,0,V.uGlobal.uData.UBound,1)
	F.Intrinsic.Math.Add(V.Local.iCount,1,V.Local.iRow)
	V.uGlobal.uData(v.Local.iCount)!Row.Set(V.Local.iRow)
	V.Global.iRowCount.Set(V.Local.iRow)
F.Intrinsic.Control.Next(V.Local.iCount)


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("subGenerate_RowNumbers_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.subGenerate_RowNumbers.End

Program.Sub.subLoad_fgOpenJobs.Start
F.Intrinsic.Control.SetErrorHandler("subLoad_fgOpenJobs_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Load Data into Flex Grid fg_OpenJobs

'Declare Local Variables
V.Global.iRowCount.Set(0)

'Create/Open Connection
F.ODBC.Connection!Conx.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass)

'Load UDTs
F.ODBC.Connection!Conx.OpenLocalRecordsetRO("rstJobHead",V.Global.sSqlJobHeader)
F.Intrinsic.Variable.LoadUDTFromRecordset("Conx","rstJobHead","uGlobal.uData",False,100000)
F.ODBC.Conx!rstJobHead.Close

'Close the Connection
F.ODBC.Connection!Conx.Close

F.Intrinsic.Control.CallSub(Subload_grid)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("subLoad_fgOpenJobs_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.subLoad_fgOpenJobs.End

Program.Sub.E_fgOpenJobs_MouseUp.Start
F.Intrinsic.Control.SetErrorHandler("E_fgOpenJobs_MouseUp_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'MouseUp on fgOpenJobs Flex Grid

'Sort by Column when Header Row is clicked
'Activate Link when Clicked

'Declare Local Variables (Used for String Comparison)
V.Local.sTemp.Declare(String)
V.Local.sTemp.Set("")
V.Local.sTemp2.Declare(String)
V.Local.sTemp2.Set("")
V.Local.iRelStatus.Declare(Long)
V.Local.iPrtStatus.Declare(Long)
V.Local.iMouseRow.Declare(Long)
V.Local.iMouseCol.Declare(Long)
V.Local.sTempRev.Declare(String)
V.Local.sSQL.Declare(String)

V.Local.iMouseRow.Set(V.Args.MouseRow)
V.Local.iMouseCol.Set(V.Args.MouseCol)


'COLUMN SORTING
F.Intrinsic.Control.If(V.Local.iMouseRow,=,0)
	F.Intrinsic.Control.If(V.Local.iMouseCol,<>,0)
		F.Intrinsic.Control.CallSub(Subsort,"col",V.Local.iMouseCol)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

''LINK CONTROL
F.Intrinsic.Control.If(V.Local.iMouseRow,>,0)
	'JOB/SUFFIX Clicked...
	F.Intrinsic.Control.If(V.Local.iMouseCol,>,6)
	F.Intrinsic.Control.AndIf(V.Local.iMouseCol,<,9)
		'Get Job
		Gui.F_Main.fgOpenJobs.GetTextMatrix(7,V.Local.iMouseRow,V.Local.sTemp)
		'Get Suffix
		Gui.F_Main.fgOpenJobs.GetTextMatrix(8,V.Local.iMouseRow,V.Local.sTemp2)
		F.Intrinsic.Control.If(V.Screen.F_Main!optEdit.Value,=,"True")
			'Build Call Wrapper String
			F.Intrinsic.String.Concat(V.Local.sTemp,"!*!",V.Local.sTemp2,"!*!","O",V.Local.sTemp)
			F.Global.General.CallWrapperASync(2009,V.Local.sTemp)
		F.Intrinsic.Control.Else
			'Build Call Wrapper String
			F.Intrinsic.String.Concat("7","!*!",V.Local.sTemp,"!*!",V.Local.sTemp2,"!*!","A",V.Local.sTemp)
			F.Global.General.CallWrapperASync(450000,V.Local.sTemp)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	'Part Number
	F.Intrinsic.Control.If(V.Args.MouseCol,>,8)
	F.Intrinsic.Control.AndIf(V.Args.mousecol,<,12)
		'Get Part Number
		Gui.F_Main.fgOpenJobs.GetTextMatrix(9,V.Local.iMouseRow,V.Local.sTemp)
		'Get Rev
		Gui.F_Main.fgOpenJobs.GetTextMatrix(10,V.Local.iMouseRow,V.Local.sTempRev)
		'get the short part
		f.Global.Inventory.GetGSSPart(v.Local.sTemp,v.Local.sTempRev,v.Local.sTemp)
		'Get Part Loc
		Gui.F_Main.fgOpenJobs.GetTextMatrix(11,V.Local.iMouseRow,V.Local.sTemp2)
		F.Global.Inventory.CallSD(V.Local.sTemp,V.Local.sTempRev,V.Local.sTemp2)
	F.Intrinsic.Control.EndIf

	'SO Due date open Sales order
	F.Intrinsic.Control.If(V.Args.MouseCol,=,16)
		F.ODBC.Connection!Conx.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass)
		'get work order
		Gui.F_Main.fgOpenJobs.GetTextMatrix(7,V.Local.iMouseRow,V.Local.sTemp)
		'get suffix
		Gui.F_Main.fgOpenJobs.GetTextMatrix(8,V.Local.iMouseRow,V.Local.sTemp2)
		'get the sales order based on work order
		F.Intrinsic.String.Build("SELECT SALES_ORDER, SALES_ORDER_LINE FROM V_JOB_HEADER WHERE JOB = '{0}' AND SUFFIX = '{1}' ",V.Local.sTemp,V.Local.sTemp2,V.Local.sSQL)
		F.ODBC.Connection!Conx.OpenLocalRecordsetRO("rstSO",V.Local.sSQL)
		F.Intrinsic.Control.If(V.ODBC.Conx!rstSO.EOF,=,False)
			'IF SO = 0000000 THEN SKIP
			F.Intrinsic.Control.If(V.ODBC.Conx!rstSO.FieldValTrim!SALES_ORDER,<>,"0000000","OR",V.ODBC.Conx!rstSO.FieldValTrim!SALES_ORDER,<>,"")
				'OPEN CALLWRAPPER TO OE SCREEN
				F.Intrinsic.Control.If(V.Screen.F_Main!optEdit.Value,=,True)
					F.Intrinsic.String.Build("{0}!*!O!*!!*!*!*ZDR*!*",V.ODBC.Conx!rstSO.FieldValTrim!SALES_ORDER,V.Local.sTemp)
					F.Global.General.CallWrapperAsync(200000,V.Local.sTemp)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}!*!V!*!!*!*!*ZDR*!*",V.ODBC.Conx!rstSO.FieldValTrim!SALES_ORDER,V.Local.sTemp)
					F.Global.General.CallWrapperAsync(200000,V.Local.sTemp)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.ODBC.Conx!rstSO.Close
		F.ODBC.Connection!Conx.Close
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("E_fgOpenJobs_MouseUp_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.E_fgOpenJobs_MouseUp.End

Program.Sub.E_fgOpenJobs_CellEnter.Start
F.Intrinsic.Control.SetErrorHandler("E_fgOpenJobs_CellEnter_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Cell Enter on fgSales Flex Grid

'Store Information on Cell being Entered for Future Comparison
V.Global.iOldRow.Set(V.Args.Key)
Gui.F_Main.fgOpenJobs.GetTextMatrix(V.Args.Column,V.Global.iOldRow,V.Global.sOldValue)
F.Intrinsic.String.Len(V.Global.sOldValue,V.Global.iOldLength)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("E_fgOpenJobs_CellEnter_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.E_fgOpenJobs_CellEnter.End

program.sub.fgopenjobs_posttextmatrix.start
F.Intrinsic.Control.SetErrorHandler("fgopenjobs_posttextmatrix_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Post Text Matrix on fgSales Flex Grid

'Declare Local Variables
V.Local.iCurrentRow.declare(Long)
V.Local.iCurrentLength.Declare(Long)
V.Local.bSubMatch.Declare(Boolean)
V.Local.sSqlUpdate.Declare(String)
V.Local.sUpdateText.Declare(String)
V.Local.sUpdateText.Set("")
V.Local.iRow.Declare(Long)
V.Local.iRow.Set(0)
V.Local.sJobNo.Declare(String)
V.Local.sJobNo.Set("")
V.Local.sJobSuffix.Declare(String)
V.Local.sJobSuffix.Set("")
V.Local.iTestRowCount.Declare(Long)
V.Local.iTestRowCount.Set(0)

'Populate Variables
V.Local.iRow.Set(V.Args.Key)
Gui.F_Main.fgOpenJobs.GetTextMatrix(21,V.Local.iRow,V.Local.sUpdateText)
F.Intrinsic.String.Trim(V.Local.sUpdateText,V.Local.sUpdateText)
Gui.F_Main.fgOpenJobs.GetTextMatrix(7,V.Local.iRow,V.Local.sJobNo)
Gui.F_Main.fgOpenJobs.GetTextMatrix(8,V.Local.iRow,V.Local.sJobSuffix)

'Generate Lookup SQL Statement
V.Local.sSqlUpdate.Set("SELECT * FROM WO_USER_FLDS WHERE JOB = '")
F.Intrinsic.String.Concat(V.Local.sSqlUpdate,V.Local.sJobNo,"' AND SUFFIX = '",V.Local.sJobSuffix,"';",V.Local.sSqlUpdate)

'Test to See if Record Already Exists (Update vs. Insert)
'Create/Open Connection
F.ODBC.Connection!Conx.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass)

'Execute Lookup Statement
F.ODBC.Connection!Conx.OpenRecordsetRO("rstTest",V.Local.sSqlUpdate)
'Loop through the rstTest recordset and count the rows (should be 1 or 0)
F.Intrinsic.Control.DoUntil(V.ODBC.conx!rstTest.EOF,=,True)
	'Add up the Rows
	F.Intrinsic.Math.Add(V.Global.iRowCount,1,V.Local.iTestRowCount)
	F.ODBC.conx!rstTest.MoveNext
F.Intrinsic.Control.Loop

'Close the Record Set
F.ODBC.conx!rstTest.Close

F.Intrinsic.Control.If(V.Local.sUpdateText,<>,V.Global.sOldValue)
	'Test For Update/Insert
	F.Intrinsic.Control.If(V.Local.iTestRowCount,>,0)
		'Record Found... Update... NOT Insert
		'Generate Update SQL Statement

		F.Intrinsic.Control.If(V.Args.Column,=,21)
			'Update Work Order Notes (User_6 Field)
			V.Local.sSqlUpdate.Set("UPDATE WO_USER_FLDS SET User_6 = '")
			F.Intrinsic.String.Concat(V.Local.sSqlUpdate,V.Local.sUpdateText,"' WHERE JOB = '",V.Local.sJobNo,"' AND SUFFIX = '",V.Local.sJobSuffix,"';",V.Local.sSqlUpdate)
		F.Intrinsic.Control.EndIf

		'Execute Update Statement
		F.ODBC.connection!Conx.Execute(V.Local.sSqlUpdate)

		'If No Errors
		F.Intrinsic.UI.Msgbox("Change Updated Successfully","Success")

	F.Intrinsic.Control.Else
		'No Record Found... Insert... NOT Update
		'Generate Insert SQL Statement


		F.Intrinsic.Control.If(V.Args.Column,=,21)

			'Insert Work Order Notes (User_6 Field)
			V.Local.sSqlUpdate.Set("INSERT INTO WO_USER_FLDS (JOB, SUFFIX, USER_6) VALUES ('")
			F.Intrinsic.String.Concat(V.Local.sSqlUpdate,V.Local.sJobNo,"', '",V.Local.sJobSuffix,"', '",V.Local.sUpdateText,"');",V.Local.sSqlUpdate)
		F.Intrinsic.Control.EndIf

		'Execute Update Statement
		F.ODBC.connection!Conx.Execute(V.Local.sSqlUpdate)

		'If No Errors
		F.Intrinsic.UI.Msgbox("Change Saved Successfully","Success")
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf


'Close the Connection
F.ODBC.Connection!Conx.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("fgopenjobs_posttextmatrix_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

program.sub.fgopenjobs_posttextmatrix.End

Program.Sub.subLoad_Grid.Start
F.Intrinsic.Control.SetErrorHandler("subLoad_Grid_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

V.Local.iCount.Declare(Long)
V.Local.iC.Declare(Long,-1)
V.Local.sLine.Declare(String)
V.Local.fEstH.Declare(Float)
V.Local.sGrade.Declare(String)
V.Local.sSeek.Declare(String)
V.Local.sLongPart.Declare(String)

V.Global.iProgBarVal.Set(0)
V.Global.iProgBarTotalVal.Set(V.uGlobal.uData.UBound)
F.Intrinsic.Math.Div(V.Global.iProgBarTotalVal,100,V.Global.iProgBarTotalVal)


F.Intrinsic.Control.If(V.Global.iProgBarTotalVal,=,0)
	V.Global.iProgBarTotalVal.Set(1)
F.Intrinsic.Control.EndIf

'loop through the udt and set the part rev
F.Intrinsic.Control.For(V.Local.iCount,V.uGlobal.uData.LBound,V.uGlobal.uData.UBound,1)
	F.Intrinsic.String.RPad(V.uGlobal.uData(v.Local.iCount)!Part," ",20,V.uGlobal.uData(v.Local.iCount)!Part)
	V.uGlobal.uData(v.Local.iCount)!REV.Set(V.uGlobal.uData(v.Local.iCount)!Part.Right3)
	V.uGlobal.uData(v.Local.iCount)!REV.Set(V.uGlobal.uData(v.Local.iCount)!REV.Trim)
	V.uGlobal.uData(v.Local.iCount)!Part.Set(V.uGlobal.uData(v.Local.iCount)!Part.Left17)
	V.uGlobal.uData(v.Local.iCount)!Part.Set(V.uGlobal.uData(v.Local.iCount)!Part.Trim)

	'convert to long part
	f.Global.Inventory.GetDisplayPart(v.uGlobal.uData(v.Local.iCount)!Part,v.uGlobal.uData(v.Local.iCount)!Rev,v.Local.sLongPart)
	F.Intrinsic.Control.If(V.Local.sLongPart,<>,"")
		F.Intrinsic.String.Split(V.Local.sLongPart,"*!*",V.Local.sLongPart)
		V.Local.sLongPart.RedimPreserve(0,1)
		V.uGlobal.uData(v.Local.iCount)!Part.Set(V.Local.sLongPart(0).Trim)
		V.uGlobal.uData(v.Local.iCount)!Rev.Set(V.Local.sLongPart(1).Trim)
		V.Local.sLongPart.Redim(0,0)
		V.Local.sLongPart.Set("")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Global.fProgBarValue,<,100)
		F.Intrinsic.Math.Add(V.Global.iProgBarVal,1,V.Global.iProgBarVal)
		F.Intrinsic.Math.Div(V.Global.iProgBarVal,V.Global.iProgBarTotalVal,V.Global.fProgBarValue)
		Gui.F_Main.prgLoad.Value(V.Global.fProgBarValue)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.iCount)

F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Wo_Due_date,0,V.uGlobal.uData!Job,0,V.uGlobal.uData!Suffix,0)


F.Intrinsic.Control.CallSub(Subgenerate_rownumbers)

Gui.F_Main.fgOpenJobs.LoadFromUDT("V.uGlobal.uData","ROW::0*!*SAMPLE::1*!*HOLD::2*!*LOCK::3*!*Print::4*!*Released::5*!*MISSUED::6*!*Job::7*!*Suffix::8*!*Part::9*!*REV::10*!*Loc::11*!*QTY_ORDER::12*!*QTY_LEFT::13*!*DATE_START::14*!*WO_DUE_DATE::15*!*SO_DUE_DATE::16*!*SCHEDULED_DUE_DATE::17*!*EST_HOURS::18*!*ACT_HOURS::19*!*REM::20*!*WO_NOTE::21*!*DATE_RELEASED::22",0,V.Global.iPageFrom,V.Global.iPageTo)

'Gui.F_Main.fgOpenJobs.LoadFromUDT("V.uGlobal.uData","ROW::0*!*HOLD::1*!*LOCK::2*!*Print::3*!*Released::4*!*MISSUED::5*!*Job::6*!*Suffix::7*!*Part::8*!*REV::9*!*Loc::10*!*QTY_ORDER::11*!*QTY_LEFT::12*!*DATE_START::13*!*WO_DUE_DATE::14*!*SO_DUE_DATE::15*!*SCHEDULED_DUE_DATE::16*!*EST_HOURS::17*!*ACT_HOURS::18*!*REM::19*!*WO_NOTE::20*!*DATE_RELEASED::21",0,V.Global.iPageFrom,V.Global.iPageTo)

F.Intrinsic.Control.CallSub(Subchangegridstyle)


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("subLoad_Grid_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.subLoad_Grid.End

program.sub.cmdfilter_click.start
F.Intrinsic.Control.SetErrorHandler("cmdfilter_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Sub Used to Refresh the Screen (the Grid)
'Sub called when View/Refresh is Clicked...
'Clear the Screen/Variables and Walk through the Load Process

V.Local.iC.Declare(Long)

'Disbale lblLoadMsg
Gui.F_Main.lblLoadMsg.Visible(False)

'Disable the Flex Grid while loading...
Gui.F_Main.fgOpenJobs.Enabled(False)
Gui.F_Main.fgOpenJobs.Visible(False)

'Disable the GUI
Gui.F_Main..Enabled(False)

'Reset Progress Load Bar
Gui.F_Main.prgLoad.Value(1)
Gui.F_Main.prgLoad.Visible(True)

'Clear Refresh Msg while Loading
Gui.F_Main..Caption(V.Global.sHeader)

'Make GUI Visible (if its not Already)
Gui.F_Main..Visible(True)

'Generate SQL Statements for Pulling Data (Based on Current Settings Selected on the Form)
F.Intrinsic.Control.CallSub("subGenerate_Sql")

'%%%% UPDATE PROGRESS BAR %%%%
V.Global.fProgBarValue.Set(10)
Gui.F_Main.prgLoad.Value(V.Global.fProgBarValue)
'%%%% UPDATE PROGRESS BAR %%%%

'Make a copy of the UDT
F.Intrinsic.Variable.UDTCopy(V.uGlobal.uGrid,V.uGlobal.uData,False)

F.Intrinsic.Control.CallSub(New_cols)
'Apply filters

F.Intrinsic.Control.If(V.Screen.F_Main!chkLoc.Value,=,1)
	F.Intrinsic.Variable.UDTFlagAll(V.uGlobal.uData)
	F.Intrinsic.Variable.UDTMultiUnFlag(V.uGlobal.uData!Loc,V.Screen.F_Main!txtLoc.Text)
	F.Intrinsic.Variable.UDTDeleteFlagged(V.uGlobal.uData)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.F_Main!chkPrtRel.Value,=,1)
F.Intrinsic.UI.Msgbox(V.Screen.F_Main!cboPrtRel.Text)
	F.Intrinsic.Control.If(V.Screen.F_Main!cboPrtRel.Text,=,"Printed")
		F.Intrinsic.Variable.UDTFlagAll(V.uGlobal.uData)
		F.Intrinsic.Variable.UDTMultiUnFlag(V.uGlobal.uData!Print,"1")
		F.Intrinsic.Variable.UDTDeleteFlagged(V.uGlobal.uData)
	F.Intrinsic.Control.ElseIf(V.Screen.F_Main!cboPrtRel.Text,=,"Released")
		F.Intrinsic.Variable.UDTFlagAll(V.uGlobal.uData)
		F.Intrinsic.Variable.UDTMultiUnFlag(V.uGlobal.uData!Released,"1")
		F.Intrinsic.Variable.UDTDeleteFlagged(V.uGlobal.uData)
	F.Intrinsic.Control.ElseIf(V.Screen.F_Main!cboPrtRel.Text,=,"Print/Rel")
		F.Intrinsic.Variable.UDTFlagAll(V.uGlobal.uData)
		F.Intrinsic.Variable.UDTMultiUnFlag(V.uGlobal.uData!Print,"1",V.uGlobal.uData!Released,"1")
		F.Intrinsic.Variable.UDTDeleteFlagged(V.uGlobal.uData)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTFlagAll(V.uGlobal.uData)
		F.Intrinsic.Variable.UDTMultiUnFlag(V.uGlobal.uData!Print,"0",V.uGlobal.uData!Released,"0")
		F.Intrinsic.Variable.UDTDeleteFlagged(V.uGlobal.uData)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.Screen.F_Main!chkWODue.Value,=,1)
	F.Intrinsic.Variable.UDTUnFlagAll(V.uGlobal.uData)
	F.Intrinsic.Control.For(V.Local.iC,0,V.uGlobal.uData.UBound,1)
		F.Intrinsic.Control.If(V.Screen.F_Main!dtpDueDate.Value,<,V.uGlobal.uData(V.Local.iC)!Wo_Due_Date)
			F.Intrinsic.Variable.UDTMultiFlag(V.uGlobal.uData!Wo_Due_Date,V.uGlobal.uData(V.Local.iC)!Wo_Due_Date)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iC)
	F.Intrinsic.Variable.UDTDeleteFlagged(V.uGlobal.uData)
F.Intrinsic.Control.EndIf



'%%%% UPDATE PROGRESS BAR %%%%
V.Global.fProgBarValue.Set(40)
Gui.F_Main.prgLoad.Value(V.Global.fProgBarValue)
'%%%% UPDATE PROGRESS BAR %%%%

F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Wo_Due_Date,0,V.uGlobal.uData!Job,0,V.uGlobal.uData!Suffix,0)

F.Intrinsic.Control.CallSub(Subgenerate_rownumbers)

'%%%% UPDATE PROGRESS BAR %%%%
V.Global.fProgBarValue.Set(80)
Gui.F_Main.prgLoad.Value(V.Global.fProgBarValue)
'%%%% UPDATE PROGRESS BAR %%%%


Gui.F_Main.fgOpenJobs.LoadFromUDT("V.uGlobal.uData","ROW::0*!*SAMPLE::1*!*HOLD::2*!*LOCK::3*!*Print::4*!*Released::5*!*MISSUED::6*!*Job::7*!*Suffix::8*!*Part::9*!*REV::10*!*Loc::11*!*QTY_ORDER::12*!*QTY_LEFT::13*!*DATE_START::14*!*WO_DUE_DATE::15*!*SO_DUE_DATE::16*!*SCHEDULED_DUE_DATE::17*!*EST_HOURS::18*!*ACT_HOURS::19*!*REM::20*!*WO_NOTE::21*!*DATE_RELEASED::22",0,V.Global.iPageFrom,V.Global.iPageTo)

F.Intrinsic.Control.CallSub(Subchangegridstyle)

F.Intrinsic.Control.If(V.uGlobal.uData.UBound,=,-1)
	Gui.F_Main.fgOpenJobs.Rows(1)
F.Intrinsic.Control.EndIf

Gui.F_Main.fgOpenJobs.FixedRows(1)
Gui.F_Main.fgOpenJobs.ApplyStyle(0,1)

'Update/Display Last Refresh
V.Local.sTempDateTime.Declare(String,"")
V.Local.sTempHeader.Declare(String)
V.Local.sTempHeader.Set(V.Global.sHeader)

'Re-Enable Flex Grid and GUI
Gui.F_Main.prgLoad.Visible(False)
Gui.F_Main.fgOpenJobs.Visible(True)
Gui.F_Main.fgOpenJobs.Enabled(True)
Gui.F_Main..Enabled(True)

'Set Focus on cmdView button after Initial Load
Gui.F_Main.cmdRefresh.SetFocus

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdfilter_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

program.sub.cmdfilter_click.End

program.sub.cmdpl_click.start
F.Intrinsic.Control.SetErrorHandler("cmdpl_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

V.Local.sRet.Declare(String)

Function.Intrinsic.UI.Browser(130,"",Variable.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,"=","***CANCEL***")
	F.Intrinsic.UI.Msgbox("No PL was selected")
F.Intrinsic.Control.Else
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.F_Main.txtPL.Text(V.Local.sRet(0))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdpl_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

program.sub.cmdpl_click.End

program.sub.cmdloc_click.start
F.Intrinsic.Control.SetErrorHandler("cmdloc_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

V.Local.sTitles.Declare(String)
V.Local.iWidths.Declare(Long)
V.Local.sRet.Declare(String)
F.ODBC.Connection!Conx.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass,120)
F.Intrinsic.String.Split("Location*!*Description","*!*",V.Local.sTitles)
F.Intrinsic.String.Split("1300*!*2300","*!*",V.Local.iWidths)

F.Intrinsic.UI.MiniBrowser("Select a Location",conx,"Select Location,Location_desc FROM V_LOCATIONS ORDER BY Location",V.Local.sTitles,V.Local.iWidths,V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,"=","***CANCEL***")
	F.Intrinsic.UI.Msgbox("No Location was selected")
F.Intrinsic.Control.Else
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.F_Main.txtLoc.Text(V.Local.sRet(0))
F.Intrinsic.Control.EndIf
F.ODBC.Connection!Conx.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdloc_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

program.sub.cmdloc_click.End

Program.Sub.subSort.Start
F.Intrinsic.Control.SetErrorHandler("subSort_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

Gui.F_Main.fgOpenJobs.Visible(False)
'F.Intrinsic.UI.Msgbox(V.Args.col)
F.Intrinsic.Control.If(V.Args.col.trim,<>,V.Global.iCol.Trim)
	V.Global.iCol.Set(V.Args.col.Trim)
	V.Global.bSort.Set(False)
F.Intrinsic.Control.Else
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		V.Global.bSort.Set(True)
	F.Intrinsic.Control.Else
		V.Global.bSort.Set(False)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf
F.Intrinsic.Control.SelectCase(V.Args.col)

F.Intrinsic.Control.Case(2)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Hold,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Hold,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(3)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Lock,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Lock,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(4)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Print,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Print,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(5)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Released,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Released,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(22)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!DATE_RELEASED,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!DATE_RELEASED,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(6)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!MIssued,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!MIssued,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(7)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Job,0,V.uGlobal.uData!Suffix,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Job,1,V.uGlobal.uData!Suffix,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(8)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Suffix,0,V.uGlobal.uData!Job,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Suffix,1,V.uGlobal.uData!Job,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(9)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Part,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Part,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(10)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Rev,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Rev,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(11)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Loc,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Loc,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(12)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Qty_Order,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Qty_Order,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(13)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Qty_Left,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Qty_Left,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(14)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Date_Start,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Date_Start,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(15)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!WO_Due_DATE,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!WO_DUE_Date,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(16)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!SO_Due_Date,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!SO_Due_Date,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(17)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Scheduled_Due_Date,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Scheduled_Due_Date,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(18)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Est_Hours,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Est_Hours,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(19)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Act_Hours,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Act_Hours,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Case(20)
	F.Intrinsic.Control.If(V.Global.bSort,=,False)
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Rem,0)
	F.Intrinsic.Control.Else
		F.Intrinsic.Variable.UDTMultiQuickSort(V.uGlobal.uData!Rem,1)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndSelect

F.Intrinsic.Control.CallSub(Subgenerate_rownumbers)
Gui.F_Main.fgOpenJobs.LoadFromUDT("V.uGlobal.uData","ROW::0*!*SAMPLE::1*!*HOLD::2*!*LOCK::3*!*Print::4*!*Released::5*!*MISSUED::6*!*Job::7*!*Suffix::8*!*Part::9*!*REV::10*!*Loc::11*!*QTY_ORDER::12*!*QTY_LEFT::13*!*DATE_START::14*!*WO_DUE_DATE::15*!*SO_DUE_DATE::16*!*SCHEDULED_DUE_DATE::17*!*EST_HOURS::18*!*ACT_HOURS::19*!*REM::20*!*WO_NOTE::21*!*DATE_RELEASED::22",0,V.Global.iPageFrom,V.Global.iPageTo)

F.Intrinsic.Control.CallSub(Subchangegridstyle)
F.Intrinsic.Control.If(V.uGlobal.uData.UBound,=,-1)
	Gui.F_Main.fgOpenJobs.Rows(1)
F.Intrinsic.Control.EndIf

Gui.F_Main.fgOpenJobs.Visible(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("subSort_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.subSort.End

Program.Sub.subUpdate_Released.Start
F.Intrinsic.Control.SetErrorHandler("subUpdate_Released_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

V.Local.sSql.Declare(String)
V.Local.sJob.Declare(String)
V.Local.sSuffix.Declare(String)
V.Local.iStatusR.Declare(Long)
V.Local.iStatusP.Declare(Long)
V.Local.dIniDate.Declare(Date)
V.Local.iRow.Declare(Long)
V.Local.sLine.Declare(String)
V.Local.sJob.Set(V.Args.job)
V.Local.sSuffix.Set(V.Args.suffix)
V.Local.iStatusR.Set(V.Args.statusR.Long)
V.Local.iStatusP.Set(V.Args.statusP.Long)
V.Local.iRow.Set(V.Args.row.Long)
V.Local.sDate.Declare(String)

V.Local.sConcat.Declare(String)

V.Local.sConcat.Set("Job:",V.Local.sJob," Suffix:",V.Local.sSuffix," P:",V.Local.iStatusP," R:",V.Local.iStatusR,V.Local.sConcat)

F.Intrinsic.Date.DateSerial(1900,1,1,V.Local.dIniDate)

V.Local.sSql.Set("Select DATE_RELEASED From JOB_HEADER ")
F.Intrinsic.String.Concat(V.Local.sSql,"WHERE JOB='",V.Local.sJob,"' AND SUFFIX='",V.Local.sSuffix,"'",V.Local.sSql)

F.ODBC.Connection!Conx.OpenRecordsetRW("rstUpdRel",V.Local.sSql)

F.Intrinsic.Control.If(V.Local.iStatusR,=,1)
	V.Local.sDate.Set(V.Ambient.Date.FormatMMDDYY)
	F.Intrinsic.String.Replace(V.Local.sDate,"/","",V.Local.sDate)
	F.ODBC.Conx!rstUpdRel.Set!DATE_RELEASED(V.Local.sDate)
	Gui.F_Main.fgOpenJobs.TextMatrix(22,V.Local.iRow,V.Ambient.Date)
	F.Intrinsic.Variable.UDTMultiSeek(V.uGlobal.uData!Job,V.Local.sJob,V.uGlobal.uData!Suffix,V.Local.sSuffix,V.Local.sLine)
	F.Intrinsic.Control.If(V.Local.sLine,<>,"")
		F.Intrinsic.String.Split(V.Local.sLine,"*!*",V.Local.sLine)
		V.uGlobal.uData(V.Local.sLine(0))!DATE_RELEASED.Set(V.Ambient.Date)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Else
	F.ODBC.Conx!rstUpdRel.Set!DATE_RELEASED("000000")
	Gui.F_Main.fgOpenJobs.TextMatrix(22,V.Local.iRow,"")
	F.Intrinsic.Variable.UDTMultiSeek(V.uGlobal.uData!Job,V.Local.sJob,V.uGlobal.uData!Suffix,V.Local.sSuffix,V.Local.sLine)
	F.Intrinsic.Control.If(V.Local.sLine,<>,"")
		F.Intrinsic.String.Split(V.Local.sLine,"*!*",V.Local.sLine)
		V.uGlobal.uData(V.Local.sLine(0))!DATE_RELEASED.Set(V.Local.dIniDate)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.ODBC.Conx!rstUpdRel.Update
F.ODBC.Conx!rstUpdRel.Close


V.Local.sSql.Set("Select JOB, SUFFIX, FLAG_WO_PRTD From JOB_HEADER ")
F.Intrinsic.String.Concat(V.Local.sSql,"WHERE JOB='",V.Local.sJob,"' AND SUFFIX='",V.Local.sSuffix,"'",V.Local.sSql)
F.ODBC.Connection!Conx.OpenRecordsetRW("rstUpdJobH",V.Local.sSql)
F.Intrinsic.Control.If(V.ODBC.Conx!rstUpdJobH.EOF,=,False)
	F.Intrinsic.Control.If(V.Local.iStatusR,=,1)
		F.Intrinsic.Control.If(V.Local.iStatusP,=,1)
			F.ODBC.Conx!rstUpdJobH.Set!FLAG_WO_PRTD("R")
			Gui.F_Main.fgOpenJobs.TextMatrix(4,V.Local.iRow,1)
			Gui.F_Main.fgOpenJobs.TextMatrix(5,V.Local.iRow,1)
		F.Intrinsic.Control.Else
			F.ODBC.Conx!rstUpdJobH.Set!FLAG_WO_PRTD("X")
			Gui.F_Main.fgOpenJobs.TextMatrix(4,V.Local.iRow,0)
			Gui.F_Main.fgOpenJobs.TextMatrix(5,V.Local.iRow,1)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.Local.iStatusR,=,0)
		F.Intrinsic.Control.If(V.Local.iStatusP,=,1)
			F.ODBC.Conx!rstUpdJobH.Set!FLAG_WO_PRTD("Y")
			Gui.F_Main.fgOpenJobs.TextMatrix(4,V.Local.iRow,1)
			Gui.F_Main.fgOpenJobs.TextMatrix(5,V.Local.iRow,0)
		F.Intrinsic.Control.Else
			F.ODBC.Conx!rstUpdJobH.Set!FLAG_WO_PRTD("")
			Gui.F_Main.fgOpenJobs.TextMatrix(4,V.Local.iRow,0)
			Gui.F_Main.fgOpenJobs.TextMatrix(5,V.Local.iRow,0)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.ODBC.Conx!rstUpdJobH.Update
F.ODBC.Conx!rstUpdJobH.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("subUpdate_Released_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.subUpdate_Released.End

program.sub.fgopenjobs_checkclick.start
F.Intrinsic.Control.SetErrorHandler("fgopenjobs_checkclick_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

V.Local.sTemp.Declare(String)
V.Local.sTemp2.Declare(String)
V.Local.iRelStatus.Declare(Long)
V.Local.iPrtStatus.Declare(Long)
V.Local.sSQL.Declare(String)
V.Local.sDueDate.Declare(String)
V.Local.dDuedate.Declare(Date)
V.Local.iMonth.Declare(Long)
V.Local.iDay.Declare(Long)
V.Local.iYear.Declare(Long)

V.Global.iMouseRowChk.Set(V.Args.Key)
V.Global.iMouseColChk.Set(V.Args.Column)

'Checkbox Options
F.Intrinsic.Control.If(V.Global.iMouseRowChk,>,0)
	F.ODBC.Connection!Conx.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass)
	'Hold Clicked...
	F.Intrinsic.Control.If(V.Global.iMouseColChk,=,2)
		'do hold stuff
		Gui.F_Main.fgOpenJobs.GetTextMatrix(2,V.Global.iMouseRowChk,V.Local.iRelStatus)
		'Get Job
		Gui.F_Main.fgOpenJobs.GetTextMatrix(7,V.Global.iMouseRowChk,V.Local.sTemp)
		'Get Suffix
		Gui.F_Main.fgOpenJobs.GetTextMatrix(8,V.Global.iMouseRowChk,V.Local.sTemp2)
		'set the flag
		F.Intrinsic.String.Build("SELECT FLAG_HOLD FROM JOB_HEADER WHERE JOB = '{0}' AND SUFFIX = '{1}' ",V.Local.sTemp.Trim,V.Local.sTemp2.Trim,V.Local.sSQL)
		F.ODBC.Connection!Conx.OpenLocalRecordsetRW("rstHold",V.Local.sSQL)
		F.Intrinsic.Control.If(V.ODBC.Conx!rstHold.EOF,=,False)
			F.Intrinsic.Control.If(V.Local.iRelStatus,=,0)
				F.ODBC.Conx!rstHold.Set!FLAG_HOLD("")
			F.Intrinsic.Control.Else
				F.ODBC.Conx!rstHold.Set!FLAG_HOLD("Y")
			F.Intrinsic.Control.EndIf
			F.ODBC.Conx!rstHold.Update
		F.Intrinsic.Control.EndIf
		F.ODBC.Conx!rstHold.Close
	F.Intrinsic.Control.EndIf

	'Lock Clicked	
	F.Intrinsic.Control.If(V.Global.iMouseColChk,=,3)
		'GET LOCK STATUS
		Gui.F_Main.fgOpenJobs.GetTextMatrix(3,V.Global.iMouseRowChk,V.Local.iRelStatus)
		'Get Job
		Gui.F_Main.fgOpenJobs.GetTextMatrix(7,V.Global.iMouseRowChk,V.Local.sTemp)
		'Get Suffix
		Gui.F_Main.fgOpenJobs.GetTextMatrix(8,V.Global.iMouseRowChk,V.Local.sTemp2)
		'Get Released and Printed status
		F.Intrinsic.String.Build("SELECT JOB_LOCKED FROM JOB_HEADER WHERE JOB = '{0}' AND SUFFIX = '{1}' ",V.Local.sTemp.Trim,V.Local.sTemp2.Trim,V.Local.sSQL)
		F.ODBC.Connection!Conx.OpenLocalRecordsetRW("rstLock",V.Local.sSQL)
		F.Intrinsic.Control.If(V.ODBC.Conx!rstLock.EOF,=,False)
			F.Intrinsic.Control.If(V.Local.iRelStatus,=,0)
				F.ODBC.Conx!rstLock.Set!JOB_LOCKED("N")
			F.Intrinsic.Control.Else
				F.ODBC.Conx!rstLock.Set!JOB_LOCKED("Y")
			F.Intrinsic.Control.EndIf
			F.ODBC.Conx!rstLock.Update
		F.Intrinsic.Control.EndIf
		F.ODBC.Conx!rstLock.Close

		Gui.F_Main.fgOpenJobs.GetTextMatrix(3,V.Global.iMouseRowChk,V.Local.sTemp)
		Gui.F_Main.fgOpenJobs.GetTextMatrix(14,V.Global.iMouseRowChk,V.Local.sDueDate)
		F.Intrinsic.Control.If(V.Local.sDueDate,=,"","OR",V.Local.sDueDate,=,"0")
			V.Local.sDueDate.Set("01/01/2039")
			F.Intrinsic.Date.ConvertDString(V.Local.sDueDate,"mm/dd/yyyy",V.Local.dDueDate)
		F.Intrinsic.Control.Else
			F.Intrinsic.Date.Day(V.Local.sDueDate,V.Local.iDay)
			F.Intrinsic.Date.Month(V.Local.sDueDate,V.Local.iMonth)
			F.Intrinsic.Date.Year(V.Local.sDueDate,V.Local.iYear)
			F.Intrinsic.Date.DateSerial(V.Local.iYear,V.Local.iMonth,V.Local.iDay,V.Local.dDueDate)
		F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.If(V.Local.sTemp,=,1,"AND",V.Ambient.Date,>,V.Local.dDueDate)
			Gui.F_Main.fgOpenJobs.GSGOverrideProperty(3,V.Global.iMouseRowChk,"BackColor",V.Color.LtRed)
		F.Intrinsic.Control.Else
			'turn it back regular color....
			F.Intrinsic.Control.CallSub(Redostyle)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf

	'Print Clicked
	F.Intrinsic.Control.If(V.Global.iMouseColChk,=,3)
		'Get Job
		Gui.F_Main.fgOpenJobs.GetTextMatrix(7,V.Global.iMouseRowChk,V.Local.sTemp)
		'Get Suffix
		Gui.F_Main.fgOpenJobs.GetTextMatrix(8,V.Global.iMouseRowChk,V.Local.sTemp2)
		'Get Released and Printed status
		Gui.F_Main.fgOpenJobs.GetTextMatrix(5,V.Global.iMouseRowChk,V.Local.iRelStatus)
		Gui.F_Main.fgOpenJobs.GetTextMatrix(4,V.Global.iMouseRowChk,V.Local.iPrtStatus)

		F.Intrinsic.Control.CallSub(Subupdate_released,"job",V.Local.sTemp,"suffix",V.Local.sTemp2,"statusR",V.Local.iRelStatus,"statusP",V.Local.iPrtStatus,"row",V.Global.iMouseRowChk)
'		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf

	'Released Checked
	F.Intrinsic.Control.If(V.Global.iMouseColChk,=,5)
		'Get Job
		Gui.F_Main.fgOpenJobs.GetTextMatrix(7,V.Global.iMouseRowChk,V.Local.sTemp)
		'Get Suffix
		Gui.F_Main.fgOpenJobs.GetTextMatrix(8,V.Global.iMouseRowChk,V.Local.sTemp2)
		'Get Released and Printed status
		Gui.F_Main.fgOpenJobs.GetTextMatrix(5,V.Global.iMouseRowChk,V.Local.iRelStatus)
		Gui.F_Main.fgOpenJobs.GetTextMatrix(4,V.Global.iMouseRowChk,V.Local.iPrtStatus)

		F.Intrinsic.Control.CallSub(Subupdate_released,"job",V.Local.sTemp,"suffix",V.Local.sTemp2,"statusR",V.Local.iRelStatus,"statusP",V.Local.iPrtStatus,"row",V.Global.iMouseRowChk)
'		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.EndIf

	F.ODBC.Connection!Conx.Close

F.intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("fgopenjobs_checkclick_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

program.sub.fgopenjobs_checkclick.End

Program.Sub.sub_CheckTables.Start
F.Intrinsic.Control.SetErrorHandler("sub_CheckTables_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

V.Local.bTable.Declare(Boolean)

'Create/Open Connection
F.ODBC.Connection!Conx.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass)

F.ODBC.Connection!Conx.TableExists("GCG_3652_WO_RELDT",V.Local.bTable)
F.Intrinsic.Control.If(V.Local.bTable,=,False)
	F.ODBC.Connection!Conx.Execute("CREATE TABLE GCG_3652_WO_RELDT(JOB CHAR(6), SUFFIX CHAR(3), REL_DATE DATE, USERID CHAR(8)); ")
F.Intrinsic.Control.EndIf


'Close the Connection
F.ODBC.Connection!Conx.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("sub_CheckTables_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.sub_CheckTables.End

Program.Sub.subChangeGridStyle.Start
F.Intrinsic.Control.SetErrorHandler("subChangeGridStyle_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

V.Local.iRows.Declare(Long)
V.Local.iC.Declare(Long)
V.Local.sDueDate.Declare(String)
V.Local.dDueDate.Declare(Date)
V.Local.sPriority.Declare(String)
V.Local.iDay.Declare(Long)
V.Local.iMonth.Declare(Long)
V.Local.iYear.Declare(Long)
V.Local.sTemp.Declare(String)
V.Local.dSchedDueDate.Declare(Date)
V.Local.ssample.Declare(String)

Gui.F_Main.fgOpenJobs.Visible(False)
F.Intrinsic.Math.Sub(V.Screen.F_Main!fgOpenJobs.Rows,1,V.Local.iRows)
F.Intrinsic.Control.For(V.Local.iC,1,V.Local.iRows,1)
	Gui.F_Main.fgOpenJobs.GetTextMatrix(16,V.Local.iC,V.Local.sDueDate)
	F.Intrinsic.Control.If(V.Local.sDueDate,<>,"")
		F.Intrinsic.Date.Day(V.Local.sDueDate,V.Local.iDay)
		F.Intrinsic.Date.Month(V.Local.sDueDate,V.Local.iMonth)
		F.Intrinsic.Date.Year(V.Local.sDueDate,V.Local.iYear)
		F.Intrinsic.Date.DateSerial(V.Local.iYear,V.Local.iMonth,V.Local.iDay,V.Local.dDueDate)
	F.Intrinsic.Control.Else
		F.Intrinsic.Date.ConvertDString("01/01/2039","MM/DD/YYYY",V.Local.dDueDate)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Screen.F_Main!optEdit.Value,=,True)
'Edit
		F.Intrinsic.Control.If(V.Local.dDueDate,<,V.Ambient.Date)
			Gui.F_Main.fgOpenJobs.ApplyStyle(V.Local.iC,5)
		F.Intrinsic.Control.Else
			Gui.F_Main.fgOpenJobs.ApplyStyle(V.Local.iC,4)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
'View
		F.Intrinsic.Control.If(V.Local.dDueDate,<,V.Ambient.Date)
			Gui.F_Main.fgOpenJobs.ApplyStyle(V.Local.iC,3)
		F.Intrinsic.Control.Else
			Gui.F_Main.fgOpenJobs.ApplyStyle(V.Local.iC,2)
		F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.EndIf

'change lock field
	Gui.F_Main.fgOpenJobs.GetTextMatrix(3,V.Local.iC,V.Local.sTemp)
	Gui.F_Main.fgOpenJobs.GetTextMatrix(16,V.Local.iC,V.Local.sDueDate)
	F.Intrinsic.Control.If(V.Local.sDueDate,=,"","OR",V.Local.sDueDate,=,"0")
		V.Local.sDueDate.Set("01/01/2039")
		F.Intrinsic.Date.ConvertDString(V.Local.sDueDate,"mm/dd/yyyy",V.Local.dDueDate)
	F.Intrinsic.Control.Else
		F.Intrinsic.Date.Day(V.Local.sDueDate,V.Local.iDay)
		F.Intrinsic.Date.Month(V.Local.sDueDate,V.Local.iMonth)
		F.Intrinsic.Date.Year(V.Local.sDueDate,V.Local.iYear)
		F.Intrinsic.Date.DateSerial(V.Local.iYear,V.Local.iMonth,V.Local.iDay,V.Local.dDueDate)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Local.sTemp,=,1,"AND",V.Ambient.Date,>,V.Local.dDueDate)
		Gui.F_Main.fgOpenJobs.GSGOverrideProperty(3,V.Local.iC,"BackColor",V.Color.LtRed)
	F.Intrinsic.Control.EndIf

'change scheduled date
	Gui.F_Main.fgOpenJobs.GetTextMatrix(17,V.Local.iC,V.Local.sDueDate)
	F.Intrinsic.Control.If(V.Local.sDueDate,=,"","OR",V.Local.sDueDate,=,"0")
		V.Local.sDueDate.Set("01/01/2039")
		F.Intrinsic.Date.ConvertDString(V.Local.sDueDate,"mm/dd/yyyy",V.Local.dSchedDueDate)
	F.Intrinsic.Control.Else
		F.Intrinsic.Date.Day(V.Local.sDueDate,V.Local.iDay)
		F.Intrinsic.Date.Month(V.Local.sDueDate,V.Local.iMonth)
		F.Intrinsic.Date.Year(V.Local.sDueDate,V.Local.iYear)
		F.Intrinsic.Date.DateSerial(V.Local.iYear,V.Local.iMonth,V.Local.iDay,V.Local.dSchedDueDate)
	F.Intrinsic.Control.EndIf

	Gui.F_Main.fgOpenJobs.GetTextMatrix(15,V.Local.iC,V.Local.sDueDate)
	F.Intrinsic.Control.If(V.Local.sDueDate,=,"","OR",V.Local.sDueDate,=,"0")
		V.Local.sDueDate.Set("01/01/2039")
		F.Intrinsic.Date.ConvertDString(V.Local.sDueDate,"mm/dd/yyyy",V.Local.dDueDate)
	F.Intrinsic.Control.Else
		F.Intrinsic.Date.Day(V.Local.sDueDate,V.Local.iDay)
		F.Intrinsic.Date.Month(V.Local.sDueDate,V.Local.iMonth)
		F.Intrinsic.Date.Year(V.Local.sDueDate,V.Local.iYear)
		F.Intrinsic.Date.DateSerial(V.Local.iYear,V.Local.iMonth,V.Local.iDay,V.Local.dDueDate)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Local.dDueDate,<,V.Local.dSchedDueDate)
		Gui.F_Main.fgOpenJobs.GSGOverrideProperty(17,V.Local.iC,"BackColor",V.Color.LtRed)
	F.Intrinsic.Control.EndIf
'
	Gui.F_Main.fgOpenJobs.GetTextMatrix(1,V.Local.iC,V.Local.ssample)
		F.Intrinsic.Control.If(V.Local.ssample,=,"1")
			Gui.F_Main.fgOpenJobs.GSGOverrideProperty(7,V.Local.iC,"BackColor",V.Color.Yellow)
		F.Intrinsic.Control.EndIf


F.Intrinsic.Control.Next(V.Local.iC)
Gui.F_Main.prgLoad.Visible(False)
Gui.F_Main.fgOpenJobs.Visible(True)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("subChangeGridStyle_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf

Program.Sub.subChangeGridStyle.End

Program.Sub.New_Cols.Start
F.Intrinsic.Control.SetErrorHandler("New_Cols_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSQL.Declare(String)
V.Local.iCount.Declare(Long)
V.Local.fRemHours.Declare(Float)
V.Local.sLongPart.Declare(String)
V.Local.iC.Declare(Long)
V.Local.dDefault.Declare(Date)


F.ODBC.Connection!Conx.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass)

F.Intrinsic.Date.ConvertDString("01/01/1900","MM/DD/YYYY",V.Local.dDefault)


'SEEK FOR SODATE_DUE WHERE IT = 0 AND SET TI TO DEFAULT
F.Intrinsic.Variable.UDTMultiSeek(V.uGlobal.uData!So_Due_Date,"0",V.Local.sSQL)
F.Intrinsic.Control.If(V.Local.sSQL,<>,"")
	F.Intrinsic.String.Split(V.Local.sSQL,"*!*",V.Local.sSQL)
	F.Intrinsic.Control.For(V.Local.iC,V.Local.sSQL.LBound,V.Local.sSQL.UBound,1)
		V.uGlobal.uData(V.Local.sSQL(V.Local.iC))!So_Due_Date.Set(V.Local.dDefault)
	F.Intrinsic.Control.Next(V.Local.iC)
	V.Local.sSQL.Redim(0,0)
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.If(V.uGlobal.uData.UBound,<>,-1)
	F.Intrinsic.Control.For(V.Local.iCount,V.uGlobal.uData.LBound,V.uGlobal.uData.UBound,1)

		'convert to long part
		f.Global.Inventory.GetDisplayPart(v.uGlobal.uData(v.Local.iCount)!Part,v.uGlobal.uData(v.Local.iCount)!Rev,v.Local.sLongPart)
		F.Intrinsic.Control.If(V.Local.sLongPart,<>,"")
			F.Intrinsic.String.Split(V.Local.sLongPart,"*!*",V.Local.sLongPart)
			V.Local.sLongPart.RedimPreserve(0,1)
			V.uGlobal.uData(v.Local.iCount)!Part.Set(V.Local.sLongPart(0))
			V.uGlobal.uData(v.Local.iCount)!Rev.Set(V.Local.sLongPart(1))
			V.Local.sLongPart.Redim(0,0)
			V.Local.sLongPart.Set("")
		F.Intrinsic.Control.EndIf


	F.Intrinsic.Control.Next(V.Local.iCount)
F.Intrinsic.Control.EndIf

F.ODBC.Connection!Conx.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("New_Cols_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf


Program.Sub.New_Cols.End

Program.Sub.RedoStyle.Start
F.Intrinsic.Control.SetErrorHandler("RedoStyle_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sDueDate.Declare(String)
V.Local.dDueDate.Declare(Date)
V.Local.sPriority.Declare(String)
V.Local.iDay.Declare(Long)
V.Local.iMonth.Declare(Long)
V.Local.iYear.Declare(Long)
V.Local.sTemp.Declare(String)
V.Local.dSchedDueDate.Declare(Date)
V.Local.ssample.Declare(String)

Gui.F_Main.fgOpenJobs.Visible(false)
	Gui.F_Main.fgOpenJobs.GetTextMatrix(16,V.Global.iMouseRowChk,V.Local.sDueDate)
	F.Intrinsic.Control.If(V.Local.sDueDate,<>,"")
		F.Intrinsic.Date.Day(V.Local.sDueDate,V.Local.iDay)
		F.Intrinsic.Date.Month(V.Local.sDueDate,V.Local.iMonth)
		F.Intrinsic.Date.Year(V.Local.sDueDate,V.Local.iYear)
		F.Intrinsic.Date.DateSerial(V.Local.iYear,V.Local.iMonth,V.Local.iDay,V.Local.dDueDate)
	F.Intrinsic.Control.Else
		F.Intrinsic.Date.ConvertDString("01/01/2039","MM/DD/YYYY",V.Local.dDueDate)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Screen.F_Main!optEdit.Value,=,True)
'Edit
		F.Intrinsic.Control.If(V.Local.dDueDate,<,V.Ambient.Date)
			Gui.F_Main.fgOpenJobs.ApplyStyle(V.Global.iMouseRowChk,5)
		F.Intrinsic.Control.Else
			Gui.F_Main.fgOpenJobs.ApplyStyle(V.Global.iMouseRowChk,4)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
'View
		F.Intrinsic.Control.If(V.Local.dDueDate,<,V.Ambient.Date)
			Gui.F_Main.fgOpenJobs.ApplyStyle(V.Global.iMouseRowChk,3)
		F.Intrinsic.Control.Else
			Gui.F_Main.fgOpenJobs.ApplyStyle(V.Global.iMouseRowChk,2)
		F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.EndIf

'change lock field
	Gui.F_Main.fgOpenJobs.GetTextMatrix(4,V.Global.iMouseRowChk,V.Local.sTemp)
	Gui.F_Main.fgOpenJobs.GetTextMatrix(15,V.Global.iMouseRowChk,V.Local.sDueDate)
	F.Intrinsic.Control.If(V.Local.sDueDate,=,"","OR",V.Local.sDueDate,=,"0")
		V.Local.sDueDate.Set("01/01/2039")
		F.Intrinsic.Date.ConvertDString(V.Local.sDueDate,"mm/dd/yyyy",V.Local.dDueDate)
	F.Intrinsic.Control.Else
		F.Intrinsic.Date.Day(V.Local.sDueDate,V.Local.iDay)
		F.Intrinsic.Date.Month(V.Local.sDueDate,V.Local.iMonth)
		F.Intrinsic.Date.Year(V.Local.sDueDate,V.Local.iYear)
		F.Intrinsic.Date.DateSerial(V.Local.iYear,V.Local.iMonth,V.Local.iDay,V.Local.dDueDate)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Local.sTemp,=,1,"AND",V.Ambient.Date,>,V.Local.dDueDate)
		Gui.F_Main.fgOpenJobs.GSGOverrideProperty(4,V.Global.iMouseRowChk,"BackColor",V.Color.LtRed)
	F.Intrinsic.Control.EndIf

'change cheduled date
	Gui.F_Main.fgOpenJobs.GetTextMatrix(18,V.Global.iMouseRowChk,V.Local.sDueDate)
	F.Intrinsic.Control.If(V.Local.sDueDate,=,"","OR",V.Local.sDueDate,=,"0")
		V.Local.sDueDate.Set("01/01/2039")
		F.Intrinsic.Date.ConvertDString(V.Local.sDueDate,"mm/dd/yyyy",V.Local.dSchedDueDate)
	F.Intrinsic.Control.Else
		F.Intrinsic.Date.Day(V.Local.sDueDate,V.Local.iDay)
		F.Intrinsic.Date.Month(V.Local.sDueDate,V.Local.iMonth)
		F.Intrinsic.Date.Year(V.Local.sDueDate,V.Local.iYear)
		F.Intrinsic.Date.DateSerial(V.Local.iYear,V.Local.iMonth,V.Local.iDay,V.Local.dDueDate)
	F.Intrinsic.Control.EndIf

	Gui.F_Main.fgOpenJobs.GetTextMatrix(16,V.Global.iMouseRowChk,V.Local.sDueDate)
	F.Intrinsic.Control.If(V.Local.sDueDate,=,"","OR",V.Local.sDueDate,=,"0")
		V.Local.sDueDate.Set("01/01/2039")
		F.Intrinsic.Date.ConvertDString(V.Local.sDueDate,"mm/dd/yyyy",V.Local.dDueDate)
	F.Intrinsic.Control.Else
		F.Intrinsic.Date.Day(V.Local.sDueDate,V.Local.iDay)
		F.Intrinsic.Date.Month(V.Local.sDueDate,V.Local.iMonth)
		F.Intrinsic.Date.Year(V.Local.sDueDate,V.Local.iYear)
		F.Intrinsic.Date.DateSerial(V.Local.iYear,V.Local.iMonth,V.Local.iDay,V.Local.dDueDate)
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.Local.dDueDate,<,V.Local.dSchedDueDate)
		Gui.F_Main.fgOpenJobs.GSGOverrideProperty(19,V.Global.iMouseRowChk,"BackColor",V.Color.LtRed)
	F.Intrinsic.Control.EndIf

	Gui.F_Main.fgOpenJobs.GetTextMatrix(2,V.global.iMouseRowChk,V.Local.ssample)
		F.Intrinsic.Control.If(V.Local.ssample,=,"1")
			Gui.F_Main.fgOpenJobs.GSGOverrideProperty(8,V.global.iMouserowChk,"BackColor",V.Color.Yellow)
		F.Intrinsic.Control.EndIf

Gui.F_Main.fgOpenJobs.Visible(true)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("RedoStyle_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf


Program.Sub.RedoStyle.End

program.sub.cmdnext_click.start
F.Intrinsic.Control.SetErrorHandler("cmdnext_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

F.Intrinsic.Math.Add(V.Global.iPageFrom,200,V.Global.iPageFrom)
F.Intrinsic.Math.Add(V.Global.iPageTo,200,V.Global.iPageTo)

Gui.F_Main.fgOpenJobs.Visible(false)
F.Intrinsic.Control.If(V.uGlobal.uData.UBound,>,V.Global.iPageFrom)
	Gui.F_Main.fgOpenJobs.LoadFromUDT("V.uGlobal.uData","ROW::0*!*SAMPLE::1*!*HOLD::2*!*LOCK::3*!*Print::4*!*Released::5*!*MISSUED::6*!*Job::7*!*Suffix::8*!*Part::9*!*REV::10*!*Loc::11*!*QTY_ORDER::12*!*QTY_LEFT::13*!*DATE_START::14*!*WO_DUE_DATE::15*!*SO_DUE_DATE::16*!*SCHEDULED_DUE_DATE::17*!*EST_HOURS::18*!*ACT_HOURS::19*!*REM::20*!*WO_NOTE::21*!*DATE_RELEASED::22",0,V.Global.iPageFrom,V.Global.iPageTo)

	F.Intrinsic.Control.CallSub(Subchangegridstyle)
F.Intrinsic.Control.ElseIf(V.uGlobal.uData!JOB,<>,"")
	V.Global.iPageFrom.Set(0)
	V.Global.iPageTo.Set(199)
	Gui.F_Main.fgOpenJobs.LoadFromUDT("V.uGlobal.uData","ROW::0*!*SAMPLE::1*!*HOLD::2*!*LOCK::3*!*Print::4*!*Released::5*!*MISSUED::6*!*Job::7*!*Suffix::8*!*Part::9*!*REV::10*!*Loc::11*!*QTY_ORDER::12*!*QTY_LEFT::13*!*DATE_START::14*!*WO_DUE_DATE::15*!*SO_DUE_DATE::16*!*SCHEDULED_DUE_DATE::17*!*EST_HOURS::18*!*ACT_HOURS::19*!*REM::20*!*WO_NOTE::21*!*DATE_RELEASED::22",0,V.Global.iPageFrom,V.Global.iPageTo)

	F.Intrinsic.Control.CallSub(Subchangegridstyle)
F.Intrinsic.Control.Else
	V.Global.iPageFrom.Set(0)
	V.Global.iPageTo.Set(199)
F.Intrinsic.Control.EndIf
Gui.F_Main.fgOpenJobs.Visible(true)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdnext_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf


program.sub.cmdnext_click.End

program.sub.cmdprev_click.start
F.Intrinsic.Control.SetErrorHandler("cmdprev_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

F.Intrinsic.Math.Sub(V.Global.iPageFrom,200,V.Global.iPageFrom)
F.Intrinsic.Math.Sub(V.Global.iPageTo,200,V.Global.iPageTo)

Gui.F_Main.fgOpenJobs.Visible(false)
F.Intrinsic.Control.If(V.uGlobal.uData.LBound,>,V.Global.iPageFrom,"AND",V.Global.iPageFrom,>=,0)
	Gui.F_Main.fgOpenJobs.LoadFromUDT("V.uGlobal.uData","ROW::0*!*SAMPLE::1*!*HOLD::2*!*LOCK::3*!*Print::4*!*Released::5*!*MISSUED::6*!*Job::7*!*Suffix::8*!*Part::9*!*REV::10*!*Loc::11*!*QTY_ORDER::12*!*QTY_LEFT::13*!*DATE_START::14*!*WO_DUE_DATE::15*!*SO_DUE_DATE::16*!*SCHEDULED_DUE_DATE::17*!*EST_HOURS::18*!*ACT_HOURS::19*!*REM::20*!*WO_NOTE::21*!*DATE_RELEASED::22",0,V.Global.iPageFrom,V.Global.iPageTo)

	F.Intrinsic.Control.CallSub(Subchangegridstyle)
F.Intrinsic.Control.Else
	V.Global.iPageFrom.Set(0)
	V.Global.iPageTo.Set(199)
	Gui.F_Main.fgOpenJobs.LoadFromUDT("V.uGlobal.uData","ROW::0*!*SAMPLE::1*!*HOLD::2*!*LOCK::3*!*Print::4*!*Released::5*!*MISSUED::6*!*Job::7*!*Suffix::8*!*Part::9*!*REV::10*!*Loc::11*!*QTY_ORDER::12*!*QTY_LEFT::13*!*DATE_START::14*!*WO_DUE_DATE::15*!*SO_DUE_DATE::16*!*SCHEDULED_DUE_DATE::17*!*EST_HOURS::18*!*ACT_HOURS::19*!*REM::20*!*WO_NOTE::21*!*DATE_RELEASED::22",0,V.Global.iPageFrom,V.Global.iPageTo)

	F.Intrinsic.Control.CallSub(Subchangegridstyle)
F.Intrinsic.Control.EndIf
Gui.F_Main.fgOpenJobs.Visible(true)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdprev_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3652_OpenJobReview.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.CallSub(Subexit)
Function.Intrinsic.Control.EndIf


program.sub.cmdprev_click.End

Program.Sub.Comments.Start
${$0$}$GAB_SF_OpenJobReviewVar6$}$RICARDO$}$3/5/2013$}$False
${$3$}$0$}$$}$-1$}$-1$}$$}$1/1/1900$}$'Coded by:  RRC
'Project Start Date:  03/20/2014
'Customer:  (Mike Melzer)
'ProjectName:  Open Job Review Var6
'Notes:
'    Script Allows user to Change/Update USER_6 field on WO user fields
'    Printed and Released checkboxes will Update the FLAG_WO_PRTD field in the JOB_HEADER

'Table(s):
GAB_WODASH_RELDT, Table with released date and user


${$4$}$0$}$$}$1$}$-1$}$SUPERVSR$}$2/7/2014 10:13:59 AM$}$'    Changed Fields, new UDTs
'     User in EDITWO group will be able to Open/Edit the WO
Program.Sub.Comments.End

